!function o(r,a,i){function l(t,e){if(!a[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=a[t]={exports:{}},r[t][0].call(n.exports,function(e){return l(r[t][1][e]||e)},n,n.exports,o,r,a,i)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<i.length;e++)l(i[e]);return l}({1:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var w=l(e("react")),E=e("material-ui"),o=l(e("prop-types")),a=l(e("pydio/model/data-model")),x=l(e("./LogTable")),C=l(e("./LogTools")),i=l(e("../model/Log"));function l(e){return e&&e.__esModule?e:{default:e}}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function u(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function s(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(n);return e=o?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,w["default"].Component);var e,t,n,o=f(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,e)).state={page:0,size:100,query:"",contentType:"JSON",loading:!1,results:0},e}return e=r,(t=[{key:"handleLogToolsChange",value:function(e){this.setState(s({},e))}},{key:"componentWillReceiveProps",value:function(e){void 0!==e.query&&e.query!==this.state.query&&this.setState({query:e.query,page:0}),void 0!==e.darkTheme&&this.setState({darkTheme:e.darkTheme}),void 0!==e.timeOffset&&this.setState({timeOffset:e.timeOffset})}},{key:"handleReload",value:function(){this.setState({z:Math.random()})}},{key:"handleDecrPage",value:function(){this.setState({page:Math.max(this.state.page-1,0)})}},{key:"handleIncrPage",value:function(){this.setState({page:this.state.page+1})}},{key:"handleTimestampContext",value:function(e){var t;e?(t=i.default.buildTsQuery(e,5),this.setState({tmpQuery:t,focus:e})):this.setState({tmpQuery:null,focus:null})}},{key:"handleLoadingStatusChange",value:function(e,t){this.props.onLoadingStatusChange?this.props.onLoadingStatusChange(e):this.setState({loading:e}),this.setState({results:t})}},{key:"render",value:function(){var t=this,e=this.props,n=e.pydio,o=e.noHeader,r=e.service,a=e.disableExport,i=e.currentNode,l=this.state,u=l.page,s=l.size,c=l.query,d=l.tmpQuery,f=l.focus,p=l.contentType,m=l.z,h=l.results,g=l.darkTheme,y=l.timeOffset,b=void 0===y?0:y,v=n.MessageHash["ajxp_admin.logs.1"],S=w.default.createElement(C.default,{pydio:n,service:r,focus:f,onStateChange:this.handleLogToolsChange.bind(this),disableExport:a}),e=AdminComponents.AdminStyles().body,l=e.block.props,y=e.block.container,a=0===u,e=[50,100,500,1e3];a&&h<e[0]||f||(O={pageSizes:e,prevDisabled:a,nextDisabled:h<s,onPageNext:this.handleIncrPage.bind(this),onPagePrev:this.handleDecrPage.bind(this),onPageSizeChange:function(e){t.setState({size:e,page:0})}});var O=w.default.createElement(E.Paper,j({},l,{style:y}),w.default.createElement(x.default,j({pydio:n,service:r||"syslog",page:u,size:s,query:d||c,focus:f,contentType:p,darkTheme:g,timeOffset:b,z:m,onLoadingStatusChange:this.handleLoadingStatusChange.bind(this),onTimestampContext:this.handleTimestampContext.bind(this)},O)));return o?O:w.default.createElement("div",{className:"main-layout-nav-to-stack workspaces-board"},w.default.createElement("div",{className:"vertical-layout",style:{width:"100%"}},w.default.createElement(AdminComponents.Header,{title:v,icon:i.getMetadata().get("icon_class"),actions:S,reloadAction:this.handleReload.bind(this),loading:this.state.loading}),w.default.createElement("div",{className:"layout-fill"},O)))}}])&&c(e.prototype,t),n&&c(e,n),r}();(n.default=e).propTypes={dataModel:o.default.instanceOf(a.default).isRequired},t.exports=n.default},{"../model/Log":6,"./LogTable":3,"./LogTools":4,"material-ui":"material-ui","prop-types":"prop-types","pydio/model/data-model":"pydio/model/data-model",react:"react"}],2:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};t=c(t);if(t&&t.has(e))return t.get(e);var n,o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((a=r?Object.getOwnPropertyDescriptor(e,n):null)&&(a.get||a.set)?Object.defineProperty(o,n,a):o[n]=e[n])}o.default=e,t&&t.set(e,o);return o}(e("react")),r=s(e("react-dom")),o=s(e("prop-types")),a=s(e("pydio")),l=e("cells-sdk"),g=e("material-ui"),u=s(e("clipboard"));function s(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function d(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function y(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(n);return e=o?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=a.default.requireLib("components").UserAvatar,E=function(){b(t,h["default"].Component);var e=S(t);function t(){return f(this,t),e.apply(this,arguments)}return m(t,[{key:"render",value:function(){var e=this.props,t=e.iconClassName,n=e.legend,o=e.data,e=(e.selectable,{icon:{margin:"16px 20px 0"},legend:{fontSize:12,color:"#aaaaaa",fontWeight:500,textTransform:"lowercase"},data:{fontSize:15,paddingRight:6,overflow:"hidden",textOverflow:"ellipsis",userSelect:"text"}});return h.default.createElement("div",{style:{display:"flex",marginBottom:8,overflow:"hidden"}},h.default.createElement("div",{style:{width:64}},h.default.createElement(g.FontIcon,{color:"#aaaaaa",className:t,style:e.icon})),h.default.createElement("div",{style:{flex:1}},h.default.createElement("div",{style:e.legend},n),h.default.createElement("div",{style:e.data},o)))}}]),t}(),e=function(){b(n,h["default"].Component);var t=S(n);function n(e){return f(this,n),(e=t.call(this,e)).state={copySuccess:!1},e}return m(n,[{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"attachClipboard",value:function(){var e=this.props,o=e.log;e.pydio;this.detachClipboard(),this.refs["copy-button"]&&(this._clip=new u.default(r.default.findDOMNode(this.refs["copy-button"]),{text:function(e){var n=[];return Object.keys(o).map(function(e){var t=o[e];t&&("RoleUuids"===e&&(t=t.join(",")),n.push(e+" : "+t))}),n.join("\n")}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copySuccess:!0},function(){setTimeout(function(){e.setState({copySuccess:!1})},3e3)})}.bind(this)),this._clip.on("error",function(){}.bind(this)))}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"focusPeriod",value:function(){var e=this.props;(0,e.onSelectPeriod)(e.log.Ts)}},{key:"unfocusPeriod",value:function(){var e=this.props,t=e.onSelectPeriod;e.focus&&t(null)}},{key:"render",value:function(){var e,t=this,n=this.props,o=n.log,r=n.pydio,a=n.onRequestClose,i=n.onSelectPeriod,l=n.style,u=n.focus,s=n.darkTheme,c=n.timeOffset,d=void 0===c?0:c,c=n.userDisplay,n=void 0===c?"avatar":c,c=this.state.copySuccess,s={divider:{marginTop:5,marginBottom:5},userLegend:{marginTop:-16,paddingBottom:10,textAlign:"center",color:"#9E9E9E",fontWeight:500},buttons:{position:"absolute",top:6,right:6,display:"flex"},button:{height:36,width:36,padding:8},buttonIcon:{fontSize:20,color:s?"white":null}};(o.Profile||o.RoleUuids||o.GroupPath)&&(f=[],o.Profile&&f.push("Profile: "+o.Profile),o.GroupPath&&f.push("Group: "+o.GroupPath),o.RoleUuids&&f.push("Roles: "+o.RoleUuids.join(",")),e=f.join(" - "));var f=o.Msg;"error"===o.Level&&(f=h.default.createElement("span",{style:{color:"#e53935"}},o.Msg));var p,m={};return o.JsonZaps&&(p=JSON.parse(o.JsonZaps),Object.keys(p).map(function(e){m[e]=JSON.stringify(p[e])})),h.default.createElement("div",{style:y({fontSize:13,color:"rgba(0,0,0,.87)",paddingBottom:10},l)},h.default.createElement(g.Paper,{zDepth:1,style:{backgroundColor:"#f5f5f5",marginBottom:10,position:"relative"}},h.default.createElement("div",{style:s.buttons},h.default.createElement(g.IconButton,{style:s.button,iconStyle:s.buttonIcon,iconClassName:c?"mdi mdi-check":"mdi mdi-content-copy",tooltip:"Copy log to clipboard",tooltipPosition:"bottom-left",ref:"copy-button"}),i&&h.default.createElement(g.IconButton,{style:s.button,iconStyle:y(y({},s.buttonIcon),{},{color:u?"#ff5722":s.buttonIcon.color}),iconClassName:"mdi mdi-clock",onClick:(u?this.unfocusPeriod:this.focusPeriod).bind(this),tooltip:"Show +/- 5 minutes",tooltipPosition:"bottom-left"}),h.default.createElement(g.IconButton,{style:s.button,iconStyle:s.buttonIcon,iconClassName:"mdi mdi-close",onClick:function(){t.unfocusPeriod(),a()},tooltip:"Close log detail",tooltipPosition:"bottom-left"})),"avatar"===n&&o.UserName&&h.default.createElement(w,{pydio:r,userId:o.UserName,richCard:!0,displayLabel:!0,displayAvatar:!0,noActionsPanel:!0}),"avatar"===n&&e&&h.default.createElement("div",{style:s.userLegend},e)),o.UserName&&"inline"===n&&h.default.createElement(h.Fragment,null,h.default.createElement(E,{iconClassName:"mdi mdi-account",legend:"User",data:o.UserName}),e&&h.default.createElement(E,{iconClassName:"mdi mdi-account-multiple",legend:"User Attributes",data:e}),h.default.createElement(g.Divider,{style:s.divider})),h.default.createElement(E,{iconClassName:"mdi mdi-calendar",legend:"Event Date",data:new Date(1e3*(o.Ts+d)).toLocaleString()}),h.default.createElement(E,{iconClassName:"mdi mdi-comment-text",legend:"Event Message",data:f}),h.default.createElement(E,{iconClassName:"mdi mdi-server-network",legend:"Service",data:o.Logger}),(o.RemoteAddress||o.UserAgent||o.HttpProtocol)&&h.default.createElement(g.Divider,{style:s.divider}),o.RemoteAddress&&h.default.createElement(E,{iconClassName:"mdi mdi-cast-connected",legend:"Connection IP",data:o.RemoteAddress}),o.UserAgent&&h.default.createElement(E,{iconClassName:"mdi mdi-cellphone-link",legend:"User Agent",data:o.UserAgent}),o.HttpProtocol&&h.default.createElement(E,{iconClassName:"mdi mdi-open-in-app",legend:"Protocol",data:o.HttpProtocol}),o.NodePath&&h.default.createElement(h.Fragment,null,h.default.createElement(g.Divider,{style:s.divider}),h.default.createElement(E,{iconClassName:"mdi mdi-file-tree",legend:"File/Folder",data:o.NodePath}),h.default.createElement(E,{iconClassName:"mdi mdi-folder-open",legend:"In Workspace",data:o.WsUuid})),0<Object.keys(m).length&&h.default.createElement(h.Fragment,null,h.default.createElement(g.Divider,{style:s.divider}),Object.keys(m).map(function(e){return h.default.createElement(E,{iconClassName:"mdi mdi-tag",legend:e,data:m[e]})})))}}]),n}();(n.default=e).PropTypes={pydio:o.default.instanceOf(a.default),log:o.default.instanceOf(l.LogLogMessage)},t.exports=n.default},{"cells-sdk":"cells-sdk",clipboard:"clipboard","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react","react-dom":"react-dom"}],3:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var j=o(e("react")),u=o(e("pydio")),P=e("material-ui"),s=o(e("../model/Log")),k=o(e("./LogDetail"));function o(e){return e&&e.__esModule?e:{default:e}}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function c(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function R(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(n);return e=o?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D=u.default.requireLib("components").MaterialTable,_=u.default.requireLib("boot").moment,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,j["default"].Component);var e,t,n,o=f(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=o.call(this,e)).state={logs:[],loading:!1,rootSpans:{},selectedRows:[]},e}return e=r,(t=[{key:"initRootSpans",value:function(e){if(!e||!e.length)return{logs:[],rootSpans:{}};for(var n={},t=e.map(function(e,t){return e.SpanUuid||(e.SpanUuid="span-"+t),e.SpanRootUuid||(n[e.SpanUuid]={open:!0,children:[]}),e}),o=[],r=0;r<t.length;r++){var a,i=t[r];i.SpanRootUuid&&n[i.SpanRootUuid]?(n[i.SpanRootUuid].children.push(i),i.HasRoot=!0):!i.SpanRootUuid||n[i.SpanRootUuid]?o.push(i):((a=R({},i)).SpanUuid=i.SpanRootUuid,i.HasRoot=!0,n[i.SpanRootUuid]={open:!0,children:[i]},o.push(a))}return{logs:o,rootSpans:n}}},{key:"openSpans",value:function(){for(var e=this.state,t=e.logs,n=e.rootSpans,o=[],r=0;r<t.length;r++){var a,i=t[r],l=n[i.SpanUuid];l.children.length&&(i.HasChildren=!0,i.IsOpen=l.open,i.RemoteAddress||(a=l.children.filter(function(e){return e.RemoteAddress})).length&&(i.RemoteAddress=a[0].RemoteAddress)),o.push(i),l.open&&(o=[].concat(c(o),c(l.children)))}return o}},{key:"load",value:function(e,t,n,o,r,a){var i=this,l=this.state.logs;a&&(this.setState({loading:!0}),a(!0,l.length)),u.default.startLoading(),s.default.loadLogs(e,t,n,o,r).then(function(e){u.default.endLoading();var t=i.initRootSpans(e.Logs),n=t.logs,t=t.rootSpans;i.setState({logs:n,rootSpans:t,loading:!1},function(){a&&a(!1,e.Logs?e.Logs.length:0)})}).catch(function(e){u.default.endLoading(),a&&(i.setState({loading:!1}),a(!1,l.length))})}},{key:"componentWillMount",value:function(){var e=this.props,t=e.service,n=e.page,o=e.size,e=e.onLoadingStatusChange;this.load(t,"",n,o,"JSON",e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.service,n=e.query,o=e.page,r=e.size,a=e.onLoadingStatusChange,e=e.z;n===this.props.query&&r===this.props.size&&o===this.props.page&&e===this.props.z||this.load(t,n,o,r,"JSON",a)}},{key:"render",value:function(){var t,n,o=this,e=this.state,r=e.loading,a=e.rootSpans,i=e.selectedRows,l=this.props,u=l.pydio,s=l.onTimestampContext,c=l.query,d=l.focus,f=l.darkTheme,p=l.timeOffset,m=void 0===p?0:p,h=this.props,g=h.onPageNext,y=h.onPagePrev,b=h.nextDisabled,v=h.prevDisabled,S=h.onPageSizeChange,e=h.page,l=h.size,p=h.pageSizes,h=this.openSpans();i.length&&(t={paddingBottom:20,paddingLeft:10,backgroundColor:f?"rgba(255,255,255,.17)":"#fafafa",color:f?"white":null,marginTop:-10,paddingTop:10},(C=i[0]).expandedRow&&delete C.expandedRow,n=JSON.stringify(C),h=h.map(function(e){return JSON.stringify(e)===n?R(R({},e),{},{expandedRow:j.default.createElement(k.default,{style:t,userDisplay:"inline",pydio:u,log:e,focus:d,darkTheme:f,timeOffset:m,onSelectPeriod:s,onRequestClose:function(){return o.setState({selectedRows:[]})}})}):e}));var i=u.MessageHash,O=AdminComponents.AdminStyles().body.tableMaster;O.row.transition="all 750ms cubic-bezier(0.23, 1, 0.32, 1) 0ms";var w={},E={};f&&(w={fontFamily:"monospace",fontWeight:"bold",height:24,paddingTop:4,paddingBottom:4},(O=R(R({},O),{},{row:{transition:O.row.transition,backgroundColor:"rgba(0,0,0,.87)",color:"rgba(255,255,255,.87)",height:24,borderBottomColor:"rgba(0,0,0,.87)",cursor:"pointer"}})).expandedRow=O.row,O.expanderRow={backgroundColor:"rgba(0,0,0,.5)"},E={style:{width:24,height:24,padding:0},iconStyle:{color:O.row.color}});var x,C=[{name:"Root",label:"",style:R(R({},w),{},{width:20,paddingLeft:0,paddingRight:0,overflow:"visible"}),headerStyle:{width:20,paddingLeft:0,paddingRight:0},renderCell:function(e){if(e.HasChildren)return j.default.createElement(P.IconButton,T({iconClassName:e.IsOpen?"mdi mdi-menu-down":"mdi mdi-menu-right",onClick:function(){a[e.SpanUuid].open=!a[e.SpanUuid].open,o.setState({rootSpans:a})}},E));return null}},{name:"Ts",label:u.MessageHash["settings.17"],renderCell:function(e){var t=_(1e3*(e.Ts+m)).utc().local(),t=t.isSame(Date.now(),"day")?t.format("HH:mm:ss"):t.toLocaleString();return e.HasRoot?j.default.createElement("span",{style:{display:"flex",alignItems:"center",color:O.row.color,fontFamily:O.row.fontFamily}},j.default.createElement(P.FontIcon,{className:"mdi mdi-play-circle-outline",style:{fontSize:12,marginRight:5,color:O.row.color}})," ",t):t},style:R(R({},w),{},{width:130,padding:"4px 12px"}),headerStyle:{width:130,padding:12}},{name:"Level",label:i["ajxp_admin.logs.level"]||"logs.level",hideSmall:!0,renderCell:function(e){var t=null;return"info"===e.Level?t="#1976D0":"error"===e.Level?t="#E53935":"warn"===e.Level?t="#fb8c00":"debug"===e.Level&&(t="#673AB7"),j.default.createElement("span",{style:{color:t,fontFamily:w.fontFamily}},e.Level)},style:R(R({},w),{},{width:55,padding:"4px 0",textTransform:"uppercase",fontWeight:500}),headerStyle:{width:55,padding:"12px 0"}},{name:"Logger",label:i["ajxp_admin.logs.service"],hideSmall:!0,renderCell:function(e){return e.Logger?e.Logger.replace("pydio.",""):"n/a"},style:R(R({},w),{},{width:130,padding:"4px 0"}),headerStyle:{width:130,padding:"12px 0"}},{name:"Msg",label:i["ajxp_admin.logs.message"],style:w,renderCell:function(e){var t=e.Msg;return e.NodePath?t+=" [".concat(e.NodePath,"]"):e.NodeUuid&&(t+=" [".concat(e.NodeUuid,"]")),t}}];return g&&(x={page:e+1,pageSize:l,pageSizes:p,onPageNext:function(e){return g(e-1)},onPagePrev:function(e){return y(e-1)},onPageSizeChange:S,nextDisabled:b,prevDisabled:v}),j.default.createElement(D,{data:h,columns:C,onSelectRows:function(e){o.setState({selectedRows:e}),o.props.onTimestampContext&&o.props.onTimestampContext(null)},deselectOnClickAway:!0,showCheckboxes:!1,emptyStateString:r?i["settings.33"]:c?i["ajxp_admin.logs.noresults"]:i["ajxp_admin.logs.noentries"],computeRowStyle:function(e){var t={};return!f&&e.HasRoot&&(t.backgroundColor="#F5F5F5"),t},masterStyles:O,pagination:x})}}])&&l(e.prototype,t),n&&l(e,n),r}();n.default=e,t.exports=n.default},{"../model/Log":6,"./LogDetail":2,"material-ui":"material-ui",pydio:"pydio",react:"react"}],4:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=l(e("pydio")),E=l(e("react")),i=l(e("lodash.debounce")),d=l(e("../model/Log")),x=e("material-ui"),o=e("material-ui/styles");function l(e){return e&&e.__esModule?e:{default:e}}function u(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach(function(e){s(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=o?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?m(t):e}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=a.default.requireLib("hoc"),P=e.ModernTextField,k=e.ModernSelectField,T=e.ModernStyles,R=a.default.requireLib("boot").moment,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,E["default"].Component);var e,t,n,o=p(r);function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=o.call(this,e),n=a.default.getInstance().Parameters.get("backend").ServerOffset,e=60*(new Date).getTimezoneOffset();return t.state={filter:"",filterMode:"fulltext",levelShow:!1,serviceFilterShow:!1,darkTheme:!1,serverOffset:n+e,timeOffset:0},t.publishStateChange=(0,i.default)(t.publishStateChange.bind(m(t)),250),t}return e=r,(t=[{key:"componentDidMount",value:function(){try{var e=JSON.parse(localStorage.getItem("pydio.logs.ux-state"));this.setState(e,this.publishStateChange.bind(this))}catch(e){}}},{key:"publishStateChange",value:function(){var e=this.state,t=e.filter,n=e.serviceFilter,o=e.level,r=e.remoteAddress,a=e.userName,i=e.date,l=e.endDate,u=e.darkTheme,e=e.timeOffset,i=d.default.buildQuery(t,n,o,r,a,i,l),l={darkTheme:u,timeOffset:e};localStorage.setItem("pydio.logs.ux-state",JSON.stringify(l)),this.props.onStateChange({query:i,darkTheme:u,timeOffset:e})}},{key:"handleToggleShow",value:function(e){var t=e+"Show",n=this.state[t],t=s({},t,!n);n?("date"===e||"endDate"===e?(t.date=null,t.endDate=null,t.dateShow=!1,t.endDateShow=!1):t[e]=null,t.page=0):"date"===e&&this.state.endDateShow&&(t.endDate=null,t.endDateShow=!1),this.setState(t,this.publishStateChange.bind(this))}},{key:"toggleDarkTheme",value:function(){var e=this.state.darkTheme;this.setState({darkTheme:!e},this.publishStateChange.bind(this))}},{key:"toggleUseServerOffset",value:function(){var e=this.state,t=e.serverOffset,e=e.timeOffset;this.setState({timeOffset:e?0:t},this.publishStateChange.bind(this))}},{key:"handleFilterChange",value:function(e,t){var n;this.setState((s(n={},t,e),s(n,"page",0),n),this.publishStateChange.bind(this))}},{key:"handleLevelChange",value:function(e){e=(0===this.state.level.indexOf("<")?"<":"")+e;this.handleFilterChange(e,"level")}},{key:"handleLevelCompChange",value:function(e){var t=this.state.level,t=e+(t=void 0===t?"":t).replace("<","");this.handleFilterChange(t,"level")}},{key:"handleDateChange",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;t&&e.setHours(t.getHours(),t.getMinutes());var n=this.state,t=n.endDate;n.endDateShow&&!t&&void 0!==e&&((t=new Date).setHours(23,59,59),this.setState({endDate:t})),this.setState({date:e,page:0},this.publishStateChange.bind(this))}},{key:"handleEndDateChange",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;t&&e.setHours(t.getHours(),t.getMinutes()),this.setState({endDate:e,page:0},this.publishStateChange.bind(this))}},{key:"handleExport",value:function(o){var r=this,e=this.state,t=e.filter,n=e.serviceFilter,a=e.level,i=e.remoteAddress,l=e.userName,u=e.date,s=e.endDate,e=this.props.service,c=u?u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate():"",s=d.default.buildQuery(t,n,a,i,l,u,s);d.default.downloadLogs(e||"sys",s,o).then(function(e){var t=window.URL.createObjectURL(e),n="cells-logs-";n+=c||"filtered",n+="."+o.toLowerCase(),-1<navigator.userAgent.toLowerCase().indexOf("firefox")?r.setState({exportUrl:t,exportFilename:n,exportOnClick:function(){setTimeout(function(){window.URL.revokeObjectURL(t)},100),r.setState({exportUrl:null,exportFilename:null})}}):((e=document.createElement("a")).href=t,e.download=n,e.click(),setTimeout(function(){window.URL.revokeObjectURL(t)},100))})}},{key:"render",value:function(){var o=this,e=this.props,t=e.pydio,n=e.disableExport,r=e.muiTheme,a=e.focus,i=AdminComponents.AdminStyles(r.palette),l=this.state,u=l.filter,s=l.date,c=l.dateShow,d=l.endDate,f=l.endDateShow,p=l.serviceFilter,m=l.serviceFilterShow,h=l.level,g=void 0===h?"":h,y=l.levelShow,b=l.userName,v=l.userNameShow,S=l.remoteAddress,O=l.remoteAddressShow,w=l.exportUrl,e=l.exportFilename,r=l.exportOnClick,h=l.serverOffset,l=l.timeOffset,t=t.MessageHash,b=u||p||s||d||g||b||S,S=E.default.createElement(x.FontIcon,{style:{top:0,fontSize:20},className:"mdi mdi-check"});return E.default.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",marginTop:3}},a&&E.default.createElement("div",{style:{backgroundColor:"#FBE9E7",height:35,lineHeight:"35px",fontSize:15,padding:"0 10px",marginRight:5,color:"#FF5722",borderRadius:3}},"Focus on +/- 5 minutes at ",R(new Date(1e3*(a+l))).format("HH:mm:ss")),E.default.createElement("div",{style:{marginRight:5,width:170}},E.default.createElement(P,{hintText:t["ajxp_admin.logs.3"],onChange:function(e,t){return o.handleFilterChange(t,"filter")},fullWidth:!0})),y&&E.default.createElement("div",{style:{marginRight:5,marginTop:-2,width:200}},E.default.createElement(k,{hintText:t["ajxp_admin.logs.level"],fullWidth:!0,value:g,onChange:function(e,t,n){return o.handleFilterChange(n,"level")}},E.default.createElement(x.MenuItem,{primaryText:""}),E.default.createElement(x.MenuItem,{primaryText:"ERROR",value:"ERROR",innerDivStyle:{color:"#E53935",fontWeight:500,fontSize:14}}),E.default.createElement(x.MenuItem,{primaryText:"WARN (only)",value:"WARN",innerDivStyle:{color:"#FB8C00",fontWeight:500,fontSize:14}}),E.default.createElement(x.MenuItem,{primaryText:"WARN (and higher)",value:"<WARN",innerDivStyle:{color:"#FB8C00",fontWeight:500,fontSize:14}}),E.default.createElement(x.MenuItem,{primaryText:"INFO (only)",value:"INFO",innerDivStyle:{color:"#1976D0",fontWeight:500,fontSize:14}}),E.default.createElement(x.MenuItem,{primaryText:"INFO (and higher)",value:"<INFO",innerDivStyle:{color:"#1976D0",fontWeight:500,fontSize:14}}),E.default.createElement(x.MenuItem,{primaryText:"DEBUG (only)",value:"DEBUG",innerDivStyle:{color:"#673AB7",fontWeight:500,fontSize:14}}),E.default.createElement(x.MenuItem,{primaryText:"DEBUG (and higher)",value:"<DEBUG",innerDivStyle:{color:"#673AB7",fontWeight:500,fontSize:14}}))),m&&E.default.createElement("div",{style:{marginRight:5,width:80}},E.default.createElement(P,{hintText:t["ajxp_admin.logs.service"],fullWidth:!0,value:p,onChange:function(e,t){return o.handleFilterChange(t,"serviceFilter")}})),O&&E.default.createElement("div",{style:{marginRight:5,width:80}},E.default.createElement(P,{hintText:t["ajxp_admin.logs.filter.ip"],fullWidth:!0,onChange:function(e,t){return o.handleFilterChange(t,"remoteAddress")}})),v&&E.default.createElement("div",{style:{marginRight:5,width:80}},E.default.createElement(P,{hintText:t["ajxp_admin.logs.filter.login"],fullWidth:!0,onChange:function(e,t){return o.handleFilterChange(t,"userName")}})),c&&!f&&E.default.createElement("div",{style:{display:"flex",alignItems:"center"}},E.default.createElement(x.DatePicker,j({hintText:t["ajxp_admin.logs.2"],onChange:function(e,t){return o.handleDateChange(t)},autoOk:!0,maxDate:new Date,value:s,showYearSelector:!0,style:{width:120},textFieldStyle:{width:120}},T.textField)),E.default.createElement(x.IconButton,j({iconClassName:"mdi mdi-close",tooltip:"Clear",onClick:function(){o.handleDateChange(void 0)}},i.props.header.iconButton))),f&&E.default.createElement("div",{style:{display:"flex",alignItems:"center"}},E.default.createElement(x.DatePicker,j({hintText:t["ajxp_admin.logs.filter.period.from"],onChange:function(e,t){return o.handleDateChange(t)},autoOk:!0,maxDate:new Date,value:s,showYearSelector:!0,style:{width:100},textFieldStyle:{width:96}},T.textField)),E.default.createElement(x.TimePicker,j({hintText:t["ajxp_admin.logs.filter.period.time"],disabled:!s,onChange:function(e,t){return o.handleDateChange(s,t)},autoOk:!0,value:s,style:{width:100},textFieldStyle:{width:96}},T.textField)),E.default.createElement(x.DatePicker,j({hintText:t["ajxp_admin.logs.filter.period.to"],onChange:function(e,t){return o.handleEndDateChange(t)},autoOk:!0,minDate:this.state.date,maxDate:new Date,value:d,showYearSelector:!0,style:{width:100},textFieldStyle:{width:96}},T.textField)),E.default.createElement(x.TimePicker,j({hintText:t["ajxp_admin.logs.filter.period.time"],disabled:!d,onChange:function(e,t){return o.handleEndDateChange(d,t)},autoOk:!0,value:d,style:{width:100},textFieldStyle:{width:96}},T.textField)),E.default.createElement(x.IconButton,j({iconClassName:"mdi mdi-close",tooltip:"Clear",onClick:function(){o.handleDateChange(void 0),o.handleEndDateChange(void 0)}},i.props.header.iconButton))),E.default.createElement(x.IconMenu,{iconButtonElement:E.default.createElement(x.IconButton,j({iconClassName:"mdi mdi-filter-variant",tooltip:t["ajxp_admin.logs.3"]},i.props.header.iconButton)),anchorOrigin:{vertical:"top",horizontal:"right"},targetOrigin:{vertical:"top",horizontal:"right"},desktop:!0},E.default.createElement(x.Subheader,null,t["ajxp_admin.logs.filter.legend"]),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.2"],rightIcon:c&&!f?S:null,onClick:function(){o.handleToggleShow("date")}}),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.filter.period"],rightIcon:f?S:null,onClick:function(){o.handleToggleShow("endDate")}}),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.level"],rightIcon:y?S:null,onClick:function(){o.handleToggleShow("level")}}),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.service"],rightIcon:m?S:null,onClick:function(){o.handleToggleShow("serviceFilter")}}),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.filter.login"],rightIcon:v?S:null,onClick:function(){o.handleToggleShow("userName")}}),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.filter.ip"],rightIcon:O?S:null,onClick:function(){o.handleToggleShow("remoteAddress")}})),0!==h&&E.default.createElement(x.IconMenu,{iconButtonElement:E.default.createElement(x.IconButton,j({iconClassName:"mdi mdi-alarm"+(l?"-snooze":""),tooltip:t["ajxp_admin.logs.tz.tooltip"]},i.props.header.iconButton)),anchorOrigin:{vertical:"top",horizontal:"right"},targetOrigin:{vertical:"top",horizontal:"right"},desktop:!0},E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.tz.local"],rightIcon:l?null:S,onClick:function(){o.toggleUseServerOffset()}}),E.default.createElement(x.MenuItem,{primaryText:t["ajxp_admin.logs.tz.server"],rightIcon:l?S:null,onClick:function(){o.toggleUseServerOffset()}})),!n&&E.default.createElement(x.IconMenu,{iconButtonElement:E.default.createElement(x.IconButton,j({iconClassName:"mdi mdi-download",tooltip:t["ajxp_admin.logs.11"]},i.props.header.iconButton)),anchorOrigin:{vertical:"top",horizontal:"right"},targetOrigin:{vertical:"top",horizontal:"right"},desktop:!0},!b&&E.default.createElement(x.Subheader,null,t["ajxp_admin.logs.export.disabled"]),b&&E.default.createElement(x.Subheader,null,t["ajxp_admin.logs.11"]),E.default.createElement(x.MenuItem,{primaryText:"CSV",rightIcon:E.default.createElement(x.FontIcon,{style:{top:0},className:"mdi mdi-file-delimited"}),onClick:function(){o.handleExport("CSV")},disabled:!b}),E.default.createElement(x.MenuItem,{primaryText:"XLSX",rightIcon:E.default.createElement(x.FontIcon,{style:{top:0},className:"mdi mdi-file-excel"}),onClick:function(){o.handleExport("XLSX")},disabled:!b}),w&&E.default.createElement(x.Subheader,null,E.default.createElement("a",{href:w,download:e},e))),E.default.createElement(x.Dialog,{open:!!w,modal:!0,title:t["ajxp_admin.logs.11"],actions:[E.default.createElement(x.FlatButton,{label:t[54],onClick:r})]},E.default.createElement("span",{style:{fontSize:13}},t["ajxp_admin.logs.export.clicklink"],": ",E.default.createElement("a",{style:{textDecoration:"underline"},href:w,download:e,onClick:r},e))),E.default.createElement(x.IconButton,{iconClassName:"mdi mdi-brightness-6",tooltip:t["ajxp_admin.logs.toggleTheme"],onClick:function(){return o.toggleDarkTheme()},iconStyle:C(C({},i.props.header.iconButton.iconStyle),{},{transform:this.state.darkTheme?"rotate(180deg)":""})}))}}])&&c(e.prototype,t),n&&c(e,n),r}();n.default=e,n.default=e=(0,o.muiThemeable)()(e),t.exports=n.default},{"../model/Log":6,"lodash.debounce":"lodash.debounce","material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],5:[function(e,t,n){"use strict";var o=r(e("./board/LogBoard")),e=r(e("./board/LogTools"));function r(e){return e&&e.__esModule?e:{default:e}}window.AdminLogs={Dashboard:o.default,LogTools:e.default}},{"./board/LogBoard":1,"./board/LogTools":4}],6:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(e("pydio/lang/observable")),i=o(e("pydio/http/api")),l=o(e("pydio/http/resources-manager")),u=e("cells-sdk");function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(n);return e=o?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=["ERROR","WARN","INFO","DEBUG"],e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,a["default"]);var e,t,n,o=p(r);function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o.apply(this,arguments)}return e=r,n=[{key:"buildQuery",value:function(e,t,n,o,r,a){var i,l=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0,u=[];return e&&u.push('+Msg:"*'+e+'*"'),t&&u.push("+Logger:*"+t+"*"),n&&(0===n.indexOf("<")?(i=h.indexOf(n.replace("<","")),t=h.filter(function(e,t){return t<=i}).map(function(e){return"Level:"+e}),u.push.apply(u,s(t))):u.push("+Level:"+n)),o&&u.push("+RemoteAddress:*"+o+"*"),r&&u.push("+UserName:*"+r+"*"),a&&(r=a,a=new Date(r),l?a=l:a.setDate(r.getDate()+1),u.push("+Ts:>"+Math.floor(r/1e3)),u.push("+Ts:<"+Math.floor(a/1e3))),u.join(" ")}},{key:"buildTsQuery",value:function(e,t){var n=[];return n.push("+Ts:>"+(e-60*t)),n.push("+Ts:<"+(e+60*t)),n.join(" ")}},{key:"loadLogs",value:function(e,t,n,o,r){var a=new u.LogListLogRequest;return a.Query=t,a.Page=n,a.Size=o,a.Format=u.ListLogRequestLogFormat.constructFromObject(r),"syslog"!==e?"audit"===e?l.default.loadClass("EnterpriseSDK").then(function(e){return new e.EnterpriseLogServiceApi(i.default.getRestClient()).audit(a)}):Promise.reject("Unknown service name, must be 'syslog' or 'audit'"):new u.LogServiceApi(i.default.getRestClient()).syslog(a)}},{key:"downloadLogs",value:function(e,t,n){var o=new u.LogListLogRequest;return o.Query=t,o.Page=0,o.Size=1e5,o.Format=u.ListLogRequestLogFormat.constructFromObject(n),r.auditExportWithHttpInfo(o,e).then(function(e){return e.response.body})}},{key:"auditExportWithHttpInfo",value:function(e,t){var n=e;if(null==e)throw new Error("Missing the required parameter 'body' when calling auditExport");return i.default.getRestClient().callApi("/log/"+t+"/export","POST",{},{},{},{},n,[],["application/json"],["application/json"],"Blob")}}],(t=null)&&d(e.prototype,t),n&&d(e,n),r}();n.default=e,t.exports=n.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/lang/observable":"pydio/lang/observable"}]},{},[5]);