!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ShareDialog=e()}(function(){return function r(o,i,a){function l(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return l(o[t][1][e]||e)},n,n.exports,r,o,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(o){var e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,c.Component);var n,r,e=(n=t,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=u(n);return e=r?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e});function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.apply(this,arguments)}return function(e,t,n){t&&l(e.prototype,t);n&&l(e,n)}(t,[{key:"render",value:function(){var e=this.context,t=e.messages,n=e.getMessage,e=e.isReadonly;return c.createElement(o,a({},this.props,{messages:t,getMessage:n,isReadonly:e}))}}]),t}();return e.contextTypes={messages:r.object,getMessage:r.func,isReadonly:r.func},e};var r=e("prop-types"),c=e("react");t.exports=n.default},{"prop-types":"prop-types",react:"react"}],2:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var g=i(e("react")),r=i(e("pydio")),v=i(e("./EditCellDialog")),a=i(e("pydio/model/cell")),l=i(e("pydio/http/resources-manager")),O=e("material-ui"),s=i(e("../main/ShareHelper"));function i(e){return e&&e.__esModule?e:{default:e}}function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(n);return e=r?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r=r.default.requireLib("components"),k=r.GenericCard,E=r.GenericLine,P=r.QuotaUsageLine,r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(i,g["default"].Component);var e,t,n,o=f(i);function i(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e)).state={edit:!1,model:new a.default,loading:!0},n._observer=function(){n.forceUpdate()},l.default.loadClassesAndApply(["PydioActivityStreams","PydioCoreActions"],function(){n.setState({extLibs:!0})});var r=n.props.rootNode;return r&&(r.getMetadata().has("virtual_root")?r.isLoaded()?(n.state.rootNodes=[],r.getChildren().forEach(function(e){return n.state.rootNodes.push(e)})):(r.observe("loaded",function(){var t=[];r.getChildren().forEach(function(e){return t.push(e)}),n.setState({rootNodes:t})}),r.load()):n.state.rootNodes=[r]),n}return e=i,(t=[{key:"componentDidMount",value:function(){var t=this,e=this.props,n=e.pydio,e=e.cellId;n.user.activeRepository===e?n.user.getActiveRepositoryAsCell().then(function(e){t.setState({model:e,loading:!1}),e.observe("update",t._observer)}):(this.state.model.observe("update",function(){t.setState({loading:!1}),t.forceUpdate()}),this.state.model.load(this.props.cellId))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update",this._observer)}},{key:"usersInvitations",value:function(e){s.default.sendCellInvitation(this.props.node,this.state.model,e)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.mode,o=n.pydio,i=n.editorOneColumn,a=this.state,l=a.edit,s=a.model,u=a.extLibs,c=a.rootNodes,f=a.loading,n=function(e){return o.MessageHash["share_center."+e]},a={width:350,minHeight:270};if(l)a=i?{width:350,height:500}:{width:700,height:500},e=g.default.createElement(v.default,w({},this.props,{model:s,sendInvitations:this.usersInvitations.bind(this),editorOneColumn:i}));else if(s){var p,d,y,i=(i=s.getRootNodes().map(function(e){return s.getNodeLabelInContext(e)}).join(", "))||s.getRootNodes().length+" item(s)";"infoPanel"!==r&&(y=[],s.getUuid()!==o.user.activeRepository&&y.push(g.default.createElement(O.MenuItem,{primaryText:n(246),onClick:function(){o.triggerRepositoryChange(s.getUuid()),t.props.onDismiss()}})),s.isEditable()&&(p=function(){s.deleteCell().then(function(e){t.props.onDismiss()})},d=function(){t.setState({edit:!0}),t.props.onHeightChange&&t.props.onHeightChange(500)},y.push(g.default.createElement(O.MenuItem,{primaryText:n(247),onClick:function(){return t.setState({edit:!0})}})),y.push(g.default.createElement(O.MenuItem,{primaryText:n(248),onClick:p}))));var h,m,b=[];if(u&&c&&!f&&(m=g.default.createElement(PydioActivityStreams.WatchSelector,{pydio:o,nodes:c}),h=g.default.createElement(E,{iconClassName:"mdi mdi-bell-outline",legend:o.MessageHash["meta.watch.selector.legend"],data:m,iconStyle:{marginTop:32}}),m=g.default.createElement(PydioCoreActions.BookmarkButton,{pydio:o,nodes:c,styles:{iconStyle:{color:"white"}}})),c&&!f&&c.forEach(function(e){e.getMetadata().get("ws_quota")&&b.push(g.default.createElement(P,{node:e}))}),e=g.default.createElement(k,{pydio:o,title:s.getLabel(),onDismissAction:this.props.onDismiss,otherActions:m,onDeleteAction:p,onEditAction:d,editColor:"#009688",headerSmall:"infoPanel"===r,moreMenuItems:y},!f&&s.getDescription()&&g.default.createElement(E,{iconClassName:"mdi mdi-information",legend:n(145),data:s.getDescription()}),g.default.createElement(E,{iconClassName:"mdi mdi-account-multiple",legend:n(54),data:s.getAclsSubjects(),placeHolder:!0,placeHolderReady:!f}),g.default.createElement(E,{iconClassName:"mdi mdi-folder",legend:n(249),data:i,placeHolder:!0,placeHolderReady:!f}),b,"infoPanel"!==r&&(h||g.default.createElement(E,{placeHolder:!0,placeHolderReady:!f}))),"infoPanel"===r)return e}return g.default.createElement(O.Paper,{zDepth:0,style:a},e)}}])&&u(e.prototype,t),n&&u(e,n),i}();n.default=r,t.exports=n.default},{"../main/ShareHelper":29,"./EditCellDialog":4,"material-ui":"material-ui",pydio:"pydio","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/cell":"pydio/model/cell",react:"react"}],3:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=p(e("react")),r=p(e("prop-types")),i=p(e("pydio")),u=e("material-ui"),a=e("material-ui/styles"),c=p(e("./SharedUsers")),f=p(e("./NodesPicker")),l=p(e("pydio/model/cell"));function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(n);return e=r?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?m(t):e}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=i.default.requireLib("hoc").ModernTextField,i=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,s["default"].Component);var e,t,n,r=h(o);function o(){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(m(a=r.call.apply(r,[this].concat(t))),"state",{step:"users",model:new l.default,saving:!1}),g(m(a),"submit",function(){var e=a.state.model;a.setState({saving:!0}),e.save().then(function(e){a.props.onDismiss(),a.setState({saving:!1})}).catch(function(e){pydio.UI.displayMessage("ERROR",e.message),a.setState({saving:!1})})}),g(m(a),"m",function(e){return a.props.pydio.MessageHash["share_center."+e]}),g(m(a),"computeSummaryString",function(){var e=a.state.model,t=0,n=0,r=0,o=[],i=e.getAcls();return Object.keys(i).map(function(e){e=i[e];e.Group?n++:e.Role?r++:t++}),t&&o.push(t+" "+a.m(270)),n&&o.push(n+" "+a.m(271)),r&&o.push(r+" "+a.m(272)),o=3===o.length?o[0]+", "+o[1]+a.m(274)+o[3]:0===o.length?a.m(273):o.join(a.m(274)),a.m(269).replace("%USERS",o)}),a}return e=o,(t=[{key:"getChildContext",value:function(){var n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){var e=this;this.refs.title.focus(),this.state.model.observe("update",function(){e.forceUpdate()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"render",value:function(){var e,t=this,n=[],r=this.props.pydio,o=this.state,i=o.step,a=o.model,l=o.saving,o=r.MessageHash[418];return"users"!==i&&(o=a.getLabel()),"users"===i?(e=s.default.createElement("div",null,s.default.createElement("div",null,this.m(275)),s.default.createElement(v,{ref:"title",floatingLabelText:this.m(276),value:a.getLabel(),onChange:function(e,t){a.setLabel(t)},fullWidth:!0,variant:"v2",focusOnMount:!0,onKeyPress:function(e){"Enter"===e.key&&a.getLabel()&&t.submit()}}),s.default.createElement(v,{floatingLabelText:this.m(277),value:a.getDescription(),onChange:function(e,t){a.setDescription(t)},fullWidth:!0,variant:"v2"})),a.getLabel()&&(n.push(s.default.createElement(u.FlatButton,{key:"quick",primary:!0,disabled:!a.getLabel()||l,label:this.m("cells.create.advanced"),onClick:function(){t.setState({step:"data"})}})),n.push(s.default.createElement("span",{style:{display:"inline-block",margin:"0  10px",fontSize:14,fontWeight:500,color:"#9E9E9E"}},this.m("cells.create.buttons.separator")))),n.push(s.default.createElement(u.RaisedButton,{key:"next1",disabled:!a.getLabel()||l,primary:!0,label:this.m(279),onClick:function(){t.submit()}}))):"data"===i?(e=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m(278)),s.default.createElement(c.default,{pydio:r,cellAcls:a.getAcls(),excludes:[r.user.id],onUserObjectAdd:a.addUser.bind(a),onUserObjectRemove:a.removeUser.bind(a),onUserObjectUpdateRight:a.updateUserRight.bind(a)})),n.push(s.default.createElement(u.FlatButton,{key:"prev1",primary:!1,label:r.MessageHash[304],onClick:function(){t.setState({step:"users"})}})),n.push(s.default.createElement(u.FlatButton,{key:"next2",primary:!0,label:r.MessageHash[179],onClick:function(){return t.setState({step:"label"})}}))):(e=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m("cells.create.title.fill.folders")),s.default.createElement("div",{style:{color:"#9e9e9e"}},this.computeSummaryString()),s.default.createElement("div",{style:{paddingTop:16}},s.default.createElement(f.default,{pydio:r,model:a}))),n.push(s.default.createElement(u.FlatButton,{key:"prev2",primary:!1,label:r.MessageHash[304],onClick:function(){t.setState({step:"data"})}})),n.push(s.default.createElement(u.RaisedButton,{key:"submit",disabled:l,primary:!0,label:this.m(279),onClick:this.submit.bind(this)}))),s.default.createElement("div",{style:{width:380,fontSize:13,color:"rgba(0,0,0,.87)",display:"flex",flexDirection:"column",minHeight:300}},s.default.createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:20}},s.default.createElement(u.FontIcon,{className:"icomoon-cells-full-plus"}),s.default.createElement("div",{style:{padding:20,fontSize:22}},o)),s.default.createElement("div",{style:{padding:"20px 20px 10px",flex:1}},e),s.default.createElement("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"flex-end"}},n))}}])&&d(e.prototype,t),n&&d(e,n),o}();g(n.default=i,"childContextTypes",{messages:r.default.object,getMessage:r.default.func,isReadonly:r.default.func}),n.default=i=(0,a.muiThemeable)()(i),t.exports=n.default},{"./NodesPicker":5,"./SharedUsers":7,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/model/cell":"pydio/model/cell",react:"react"}],4:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=u(e("./SharedUsers")),l=u(e("./NodesPicker")),s=u(e("../main/GenericEditor")),r=u(e("prop-types")),i=u(e("pydio"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=r?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?d(t):e}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e("react"),b=i.default.requireLib("components").ResourcePoliciesPanel,g=i.default.requireLib("hoc").ModernTextField,i=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,m.Component);var e,t,n,r=p(i);function i(){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h(d(o=r.call.apply(r,[this].concat(t))),"submit",function(){var e=o.props,t=e.model,n=e.pydio,r=t.hasDirtyRootNodes();t.save().then(function(e){o.forceUpdate(),r&&t.getUuid()===n.user.getActiveRepository()&&(n.goTo("/"),n.fireContextRefresh())}).catch(function(e){n.UI.displayMessage("ERROR",e.message)})}),o}return e=i,(t=[{key:"getChildContext",value:function(){var n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}}}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.model,r=e.sendInvitations,o=function(e){return t.MessageHash["share_center."+e]},e=m.createElement("div",null,m.createElement(g,{floatingLabelText:o(267),value:n.getLabel(),onChange:function(e,t){n.setLabel(t)},fullWidth:!0}),m.createElement(g,{floatingLabelText:o(268),value:n.getDescription(),onChange:function(e,t){n.setDescription(t)},fullWidth:!0})),o={leftStyle:{padding:10},rightStyle:{padding:10},left:[{Label:o(54),Value:"users",Component:m.createElement(a.default,{pydio:t,cellAcls:n.getAcls(),excludes:[t.user.id],sendInvitations:r,onUserObjectAdd:n.addUser.bind(n),onUserObjectRemove:n.removeUser.bind(n),onUserObjectUpdateRight:n.updateUserRight.bind(n)})},{Label:o(253),Value:"permissions",AlwaysLast:!0,Component:m.createElement(b,{pydio:t,resourceType:"cell",description:o("cell.visibility.advanced"),resourceId:n.getUuid(),style:{margin:-10},skipTitle:!0,onSavePolicies:function(){},readonly:!1,cellAcls:n.getAcls()})}],right:[{Label:o(249),Value:"content",Component:m.createElement(l.default,{pydio:t,model:n,mode:"edit"})}]};return m.createElement(s.default,{pydio:t,tabs:o,header:e,editorOneColumn:this.props.editorOneColumn,saveEnabled:n.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){n.revertChanges()}})}}])&&c(e.prototype,t),n&&c(e,n),i}();h(n.default=i,"childContextTypes",{messages:r.default.object,getMessage:r.default.func,isReadonly:r.default.func}),t.exports=n.default},{"../main/GenericEditor":27,"./NodesPicker":5,"./SharedUsers":7,"prop-types":"prop-types",pydio:"pydio",react:"react"}],5:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=i(e("react")),f=e("material-ui"),r=e("material-ui/styles"),p=i(e("pydio/model/data-model"));function i(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=r?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=e("pydio").requireLib("components").FoldersTree,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(u,c["default"].Component);var e,t,n,s=h(u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=s.call(this,e),n=e.pydio.user,r=[];n.getRepositoriesList().forEach(function(e){if("gateway"===e.getAccessType()){if(e.getId()===n.activeRepository){if("shared"===e.getOwner())return;o=e}r.push(e)}});var o,i,a=[],l=r.filter(function(e){return!e.getOwner()}),e=r.filter(function(e){return e.getOwner()});return(a=l.length&&e.length?[].concat(d(l),["DIVIDER"],d(e)):[].concat(d(l),d(e))).length&&(o=o||a[0],(e=(i=p.default.RemoteDataModelFactory({tmp_repository_id:o.getId()})).getRootNode()).getMetadata().set("repository_id",o.getId()),e.load(i.getAjxpNodeProvider())),t.state={dataModel:i,open:!1,availableWs:a,crtWs:o},t}return e=u,(t=[{key:"switchWorkspace",value:function(e){var t=p.default.RemoteDataModelFactory({tmp_repository_id:e.getId()}),n=t.getRootNode();n.getMetadata().set("repository_id",e.getId()),n.load(t.getAjxpNodeProvider()),this.setState({crtWs:e,dataModel:t})}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.setState({open:!0,anchorEl:e.currentTarget})}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"onValidateNode",value:function(){var e=this.state,t=e.node,e=e.crtWs;this.props.model.addRootNode(t,e.getId()),this.handleRequestClose()}},{key:"onNodeSelected",value:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({node:e})}},{key:"renderNodeLine",value:function(e){var t=this.props.model;return c.default.createElement(f.ListItem,{disabled:!0,leftIcon:c.default.createElement(f.FontIcon,{className:"mdi mdi-"+("LEAF"===e.Type?"file":"folder")}),primaryText:t.getNodeLabelInContext(e),rightIconButton:c.default.createElement(f.IconButton,{onClick:function(){t.removeRootNode(e.Uuid)},iconClassName:"mdi mdi-delete",tooltip:"Remove",iconStyle:{color:"rgba(0,0,0,.43)"}})})}},{key:"render",value:function(){function e(e){return l.MessageHash["share_center."+e]}var t,r=this,n=this.props,o=n.model,i=n.muiTheme,a=n.mode,l=n.pydio,s=o.getRootNodes()||[],u=[];s.map(function(e){u.push(r.renderNodeLine(e)),u.push(c.default.createElement(f.Divider,{inset:!0}))}),u.pop(),s.length||"edit"===a&&(t=c.default.createElement("span",{style:{color:"rgba(0,0,0,.54)",fontStyle:"italic"}},e(280)));n="edit"===a?c.default.createElement(f.FlatButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!0,style:{marginBottom:10},icon:c.default.createElement(f.FontIcon,{className:"mdi mdi-folder-plus"})}):c.default.createElement(f.RaisedButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!1,style:{marginBottom:10},icon:c.default.createElement(f.FontIcon,{className:"mdi mdi-folder-plus",style:{fontSize:20,marginTop:-4}})}),o=this.state,s=o.node,a=o.availableWs,o=o.crtWs;return c.default.createElement("div",null,n,c.default.createElement(f.List,null,u),t,c.default.createElement(f.Popover,{open:this.state.open,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},c.default.createElement("div",{style:{width:372,height:300,display:"flex",flexDirection:"column"}},c.default.createElement(f.DropDownMenu,{style:{height:54},value:o,onChange:function(e,t,n){r.switchWorkspace(n)}},a.map(function(e){return"DIVIDER"===e?c.default.createElement(f.Divider,null):c.default.createElement(f.MenuItem,{value:e,primaryText:e.getLabel()})})),c.default.createElement(f.Divider,null),c.default.createElement("div",{style:{marginLeft:-26,flex:"1",overflowY:"auto",fontSize:15,color:"rgba(0,0,0,.73)"}},c.default.createElement(m,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!1,draggable:!1})),c.default.createElement(f.Divider,null),c.default.createElement("div",{style:{display:"flex",padding:"4px 16px",alignItems:"center",fontSize:15}},s&&c.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.87)"}},s&&s.getPath()),!s&&c.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.54)",fontWeight:500}},e(283)),c.default.createElement(f.IconButton,{iconStyle:{color:i.palette.primary1Color},disabled:!s,iconClassName:"mdi mdi-plus-circle-outline",onClick:this.onValidateNode.bind(this)})))))}}])&&l(e.prototype,t),n&&l(e,n),u}();n.default=e,n.default=e=(0,r.muiThemeable)()(e),t.exports=n.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],6:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=e("material-ui"),f=i(e("./UserBadge")),r=i(e("../ShareContextConsumer"));function i(e){return e&&e.__esModule?e:{default:e}}function a(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){h(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(n);return e=r?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?d(t):e}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e("prop-types"),b=e("react"),e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(i,b.Component);var e,t,n,o=u(i);function i(){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return h(d(n=o.call.apply(o,[this].concat(t))),"onRemove",function(){n.props.onUserObjectRemove(n.props.cellAcl.RoleId)}),h(d(n),"onInvite",function(){var e={},t=PydioUsers.User.fromIdmUser(n.props.cellAcl.User);e[t.getId()]=t,n.props.sendInvitations(e)}),h(d(n),"onUpdateRight",function(e,t){n.props.onUserObjectUpdateRight(n.props.cellAcl.RoleId,e,t)}),n}return e=i,(t=[{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.cellAcl,i=r.pydio,a=[],l=o.User?"user":o.Group?"group":"team";if(o.User&&o.User.Login===i.user.id)return null;switch("group"!=l&&this.props.sendInvitations&&a.push({text:this.props.getMessage("45"),callback:this.onInvite}),this.props.isReadonly()||this.props.readonly||a.push({text:this.props.getMessage("257",""),callback:this.onRemove}),l){case"user":e=o.User.Attributes.displayName||o.User.Login,t=o.User.Attributes.avatar;break;case"group":e=o.Group.Attributes?o.Group.Attributes.displayName||o.Group.GroupLabel:o.Group.Uuid;break;case"team":e=o.Role?o.Role.Label:"No role found";break;default:e=o.RoleId}var s=!1,u=!1;o.Actions.map(function(e){"read"===e.Name&&(s=!0),"write"===e.Name&&(u=!0)});r=this.props.isReadonly()||this.props.readonly,i={display:"flex",width:70};a.length||(i=p(p({},i),{},{marginRight:48}));r=b.createElement("span",{style:i},b.createElement(c.Checkbox,{disabled:r,checked:s,onCheck:function(e,t){n.onUpdateRight("read",t)}}),b.createElement(c.Checkbox,{disabled:r,checked:u,onCheck:function(e,t){n.onUpdateRight("write",t)}}));return b.createElement(f.default,{label:e,avatar:t,type:l,menus:a,boxes:r})}}])&&l(e.prototype,t),n&&l(e,n),i}();h(n.default=e,"propTypes",{cellAcl:m.object.isRequired,sendInvitations:m.func,onUserObjectRemove:m.func.isRequired,onUserObjectUpdateRight:m.func.isRequired}),n.default=e=(0,r.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"./UserBadge":8,"material-ui":"material-ui","prop-types":"prop-types",react:"react"}],7:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var f=l(e("react")),r=l(e("../ShareContextConsumer")),p=l(e("./SharedUserEntry")),d=l(e("../main/ActionButton")),i=l(e("prop-types")),a=l(e("pydio"));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=r?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?y(t):e}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=a.default.requireLib("components").UsersCompleter,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(i,f["default"].Component);var e,t,n,r=c(i);function i(){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m(y(o=r.call.apply(r,[this].concat(t))),"sendInvitationToAllUsers",function(){var e=o.props,t=e.cellAcls,n=e.pydio,r=[];Object.keys(t).map(function(e){e=t[e];e.User&&e.User.Login===n.user.id||e.User&&(e=PydioUsers.User.fromIdmUser(e.User),r[e.getId()]=e)}),o.props.sendInvitations(r)}),m(y(o),"clearAllUsers",function(){Object.keys(o.props.cellAcls).map(function(e){o.props.onUserObjectRemove(e)})}),m(y(o),"valueSelected",function(e){e.IdmUser?o.props.onUserObjectAdd(e.IdmUser):o.props.onUserObjectAdd(e.IdmRole)}),o}return e=i,(t=[{key:"render",value:function(){var t=this,e=this.props,n=e.cellAcls,r=e.pydio,o=e.completerStyle,i=r.getPluginConfigs("core.auth"),a=0,l=[];Object.keys(n).map(function(e){e=n[e];e.User&&e.User.Login===r.user.id||(a++,l.push(f.default.createElement(p.default,{cellAcl:e,key:a,pydio:t.props.pydio,readonly:t.props.readonly,sendInvitations:t.props.sendInvitations,onUserObjectRemove:t.props.onUserObjectRemove,onUserObjectUpdateRight:t.props.onUserObjectUpdateRight})))});var s,u,c=[],e=Object.keys(this.props.cellAcls).length;return!e||this.props.isReadonly()||this.props.readonly||c.push(f.default.createElement(d.default,{key:"clear",callback:this.clearAllUsers,tooltipPosition:"top-center",mdiIcon:"account-minus",messageId:"180"})),e&&this.props.sendInvitations&&c.push(f.default.createElement(d.default,{key:"invite",callback:this.sendInvitationToAllUsers,tooltipPosition:"top-center",mdiIcon:"email-outline",messageId:"45"})),this.props.saveSelectionAsTeam&&1<e&&!this.props.isReadonly()&&!this.props.readonly&&c.push(f.default.createElement(d.default,{key:"team",callback:this.props.saveSelectionAsTeam,mdiIcon:"account-multiple-plus",tooltipPosition:"top-center",messageId:"509",messageCoreNamespace:!0})),this.props.withActionLinks&&(c=this.props.withActionLinks(c)),l.length&&(s=f.default.createElement("div",{style:{display:"flex",marginBottom:-8,marginTop:-8,color:"rgba(0,0,0,.33)",fontSize:12}},f.default.createElement("div",{style:{flex:1}}),f.default.createElement("div",{style:{width:43,textAlign:"center"}},f.default.createElement("span",{style:{borderBottom:"0px solid rgba(0,0,0,0.13)"}},this.props.getMessage("361",""))),f.default.createElement("div",{style:{width:43,textAlign:"center"}},f.default.createElement("span",{style:{borderBottom:"0px solid rgba(0,0,0,0.13)"}},this.props.getMessage("181"))),f.default.createElement("div",{style:{width:6}}))),this.props.isReadonly()||this.props.readonly||(u=Object.values(n).map(function(e){return e.User?e.User.Login:e.Group?e.Group.Uuid:e.Role?e.Role.Uuid:null}).filter(function(e){return!!e}),u=f.default.createElement(b,{className:"share-form-users",fieldLabel:this.props.getMessage("34"),onValueSelected:this.valueSelected,pydio:this.props.pydio,showAddressBook:!0,usersFrom:"local",excludes:u,existingOnly:!i.get("USER_CREATE_USERS")})),f.default.createElement("div",null,f.default.createElement("div",{style:o||{margin:"0 8px 16px"}},u),s,f.default.createElement("div",null,l),!l.length&&f.default.createElement("div",{style:{color:"rgba(0,0,0,0.43)",fontWeight:500,margin:"0 10px"}},this.props.getMessage("182")),0<l.length&&f.default.createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},c))}}])&&s(e.prototype,t),n&&s(e,n),i}();m(n.default=e,"propTypes",{pydio:i.default.instanceOf(a.default),cellAcls:i.default.object,saveSelectionAsTeam:i.default.func,sendInvitations:i.default.func,showTitle:i.default.bool,onUserObjectAdd:i.default.func.isRequired,onUserObjectRemove:i.default.func.isRequired,onUserObjectUpdateRight:i.default.func.isRequired}),n.default=e=(0,r.default)(e),t.exports=n.default},{"../ShareContextConsumer":1,"../main/ActionButton":26,"./SharedUserEntry":6,"prop-types":"prop-types",pydio:"pydio",react:"react"}],8:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(n);return e=r?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("prop-types"),u=e("react").Component,c=e("material-ui"),f=c.MenuItem,p=c.IconMenu,d=c.IconButton,c=e("material-ui/styles").muiThemeable,y=e("color"),e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(o,u);var e,t,n,r=l(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"renderMenu",value:function(){if(!this.props.menus||!this.props.menus.length)return null;var e=this.props.menus.map(function(e){var t;return e.checked&&(t=React.createElement("span",{className:"mdi mdi-check"})),React.createElement(f,{primaryText:e.text,onClick:e.callback,rightIcon:t})});return React.createElement(p,{iconButtonElement:React.createElement(d,{style:{width:30,height:30,padding:5},iconStyle:{fontSize:18},iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},desktop:!0},e)}},{key:"render",value:function(){var e=this.props.muiTheme.palette.avatarsColor,t="group"===this.props.type?(e=y(e).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple",style:{backgroundColor:e}})):"team"===this.props.type?(e=y(e).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple-outline",style:{backgroundColor:e}})):"temporary"===this.props.type?(e=y(e).lighten(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-plus",style:{backgroundColor:e}})):"remote_user"===this.props.type?React.createElement("span",{className:"avatar mdi mdi-account-network",style:{backgroundColor:e}}):React.createElement("span",{className:"avatar mdi mdi-account",style:{backgroundColor:e}}),n=this.renderMenu(),e=this.props.boxes;return React.createElement("div",{className:"share-dialog user-badge user-type-"+this.props.type},t,React.createElement("span",{className:"user-badge-label"},this.props.label),n,e)}}])&&i(e.prototype,t),n&&i(e,n),o}();(n.default=e).propTypes={label:r.string,avatar:r.string,type:r.string,menus:r.object,muiTheme:r.object},n.default=e=c()(e),t.exports=n.default},{color:"color","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],9:[function(d,y,h){!function(p){!function(){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var g=t(d("react")),i=t(d("../composite/CompositeModel")),v=t(d("../main/GenericEditor")),e=t(d("pydio")),O=t(d("../links/Panel")),w=(t(d("../links/SecureOptions")),t(d("../main/ShareHelper"))),k=t(d("./Mailer")),E=t(d("./NewCellsList")),l=t(d("clipboard")),P=(t(d("../links/PublicLinkTemplate")),t(d("../links/VisibilityPanel"))),S=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var i;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(d("../links/LabelPanel"));d("material-ui");function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function t(e){return e&&e.__esModule?e:{default:e}}function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function j(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(n);return e=r?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r=e.default.requireLib("hoc").PaletteModifier,M=e.default.requireLib("boot").Tooltip,e=e.default.requireLib("components"),C=e.GenericCard,L=e.GenericLine,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,g["default"].Component);var e,t,n,r=f(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,e)).state={mode:e.props.mode||"view",model:new i.default("edit"===e.props.mode)},e}return e=o,(t=[{key:"confirmAndDismiss",value:function(){var e=this.state.model,t=this.props,n=t.pydio,t=t.onDismiss;e.isDirty()&&!confirm(n.MessageHash["share_center.dialog.close.confirm.unsaved"])||t()}},{key:"attachClipboard",value:function(){function n(e){return r.MessageHash["share_center."+e]}var t,r=this.props.pydio,e=this.state.model;this.detachClipboard(),!e.getLinks().length||(t=e.getLinks()[0]).getLink()&&this.refs["copy-button"]&&(this._clip=new l.default(this.refs["copy-button"],{text:function(e){return w.default.buildPublicUrl(r,t.getLink())}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copyMessage:n("192")},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)),this._clip.on("error",function(){var e=this,t=0===p.navigator.platform.indexOf("Mac")?n(144):n(143);this.setState({copyMessage:t},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)))}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,t=t.mode;this.state.model.observe("update",function(){e.forceUpdate()}),this.state.model.load(n,"infoPanel"===t),this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update"),this.detachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"componentWillReceiveProps",value:function(e){!e.node||e.node===this.props.node&&e.node.getMetadata("pydio_shares")===this.props.node.getMetadata("pydio_shares")||this.state.model.load(e.node,"infoPanel"===e.mode)}},{key:"usersInvitations",value:function(e,t){w.default.sendCellInvitation(this.props.node,t,e)}},{key:"linkInvitation",value:function(e){try{var t=w.default.prepareEmail(this.props.node,e);this.setState({mailerData:j(j({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){try{this.state.model.save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"deleteAllShares",value:function(){var e=this.props.pydio,t=this.state.model;e.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{dialogTitleId:"share_center.composite.deleteAll",message:e.MessageHash["share_center.255"],validCallback:function(){t.stopObserving("update"),t.deleteAll().then(function(e){t.updateUnderlyingNode()})}})}},{key:"render",value:function(){function e(e){return i.MessageHash["share_center."+e]}var t=this,n=this.props,r=n.node,o=n.mode,i=n.pydio,a=n.editorOneColumn,l=n.popoverPanel,s=n.popoverRequestClose,u=this.state,c=u.model,f=u.mailerData,p=u.linkTooltip,d=u.copyMessage;if("edit"===o){var y=g.default.createElement("div",{style:{fontSize:20,padding:10}},g.default.createElement(k.default,_({},f,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),r&&e(256).replace("%s",r.getLabel())+(c.isDirty()?" *":"")),n={left:[],right:[]},h=c.getCells().filter(function(e){return e.getUuid()}),u=1<h.length?e("254c").replace("%d",h.length):1===h.length?e("254d").replace("%s",h[0].getLabel()):e("254b");n.right.push({Label:u,Value:"cells",Icon:"mdi mdi-account-multiple",Component:g.default.createElement(E.default,{pydio:i,compositeModel:c,usersInvitations:this.usersInvitations.bind(this)})});var m,f=c.getLinks();(m=f.length?f[0]:m)&&(u=!(r=[]),m.getLinkUuid()&&(u=!0,r.push(j(j({},(0,S.LinkLabelTitle)(c,m,e)),{},{content:g.default.createElement(S.default,{pydio:i,linkModel:f[0],model:c,showLayout:!0})})),f[0].isEditable()&&r.push({title:e("link.visibility.title"),content:g.default.createElement(P.default,{pydio:i,linkModel:f[0],style:{margin:-10}})})),n.left.push({Label:e(121)+(u?" ("+e("link.active")+")":""),Value:"public-link",Icon:"mdi mdi-link",Component:g.default.createElement(O.default,{pydio:i,compositeModel:c,linkModel:f[0],showMailer:w.default.mailerSupported(i)?this.linkInvitation.bind(this):null,additionalPanes:r})})),console.log(f.filter(function(e){return e.getLinkUuid()}),h.length);h=!f.filter(function(e){return e.getLinkUuid()}).length&&0<h.length?"cells":null;return g.default.createElement(v.default,{tabs:n,defaultLeft:h,pydio:i,header:y,saveEnabled:c.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:function(){return t.confirmAndDismiss()},onRevertAction:function(){c.revertChanges(!0)},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:350,color:"rgba(0,0,0,.83)",fontSize:13}})}var h=[],b=[];c.getCells().map(function(e){b.push(e.getLabel())});y=c.getLinks();return y.length&&((a=y[0]).hasError()?(y=a.hasError(),h.push(g.default.createElement(L,{iconClassName:"mdi mdi-alert-outline",legend:"Error",data:y.Detail||y.Msg||y}))):a.getLink()&&a.getLink().LinkHash&&(a=w.default.buildPublicUrl(i,a.getLink(),"infoPanel"===o),h.push(g.default.createElement(L,{iconClassName:"mdi mdi-link",legend:e(121),style:{overflow:"visible"},dataStyle:{overflow:"visible"},data:g.default.createElement("div",{ref:"copy-button",style:{cursor:"pointer",position:"relative"},onMouseOver:function(){t.setState({linkTooltip:!0})},onMouseOut:function(){t.setState({linkTooltip:!1})}},g.default.createElement(M,{label:d||e(191),horizontalPosition:"left",verticalPosition:"top",show:p}),a)})))),b.length&&h.push(g.default.createElement(L,{iconClassName:"mdi mdi-account-multiple",legend:e(254),data:b.join(", ")})),g.default.createElement(C,{pydio:i,title:i.MessageHash["share_center.50"],onDismissAction:this.props.onDismiss,onDeleteAction:function(){s&&s(),t.deleteAllShares()},onEditAction:function(){s&&s(),i.Controller.fireAction("share-edit-shared")},editTooltip:i.MessageHash["share_center.125"],deleteTooltip:i.MessageHash["share_center.composite.deleteAll"],headerSmall:"infoPanel"===o,popoverPanel:l,popoverRequestClose:s},h,!h.length&&g.default.createElement(L,{placeHolder:!0}))}}])&&u(e.prototype,t),n&&u(e,n),o}();h.default=e,h.default=e=r({primary1Color:"#009688"})(e),y.exports=h.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../composite/CompositeModel":11,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":12,"./NewCellsList":13,clipboard:"clipboard","material-ui":"material-ui",pydio:"pydio",react:"react"}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(e("./CompositeCard")),o=l(e("pydio/model/data-model")),i=l(e("prop-types")),a=l(e("pydio"));function l(e){return e&&e.__esModule?e:{default:e}}var s=e("react"),i=e("create-react-class")({displayName:"CompositeDialog",mixins:[e("pydio").requireLib("boot").ActionDialogMixin],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogPadding:!1,dialogSize:"md+"}},propTypes:{pydio:i.default.instanceOf(a.default).isRequired,selection:i.default.instanceOf(o.default),readonly:i.default.bool},childContextTypes:{messages:i.default.object,getMessage:i.default.func,isReadonly:i.default.func},getChildContext:function(){var e=this,n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return e.props.readonly}}},shouldComponentUpdate:function(e,t){return!!this.props.selection.getUniqueNode()},render:function(){var e,t=this.props,n=t.pydio,t=t.selection;return t.getUniqueNode()&&(e=t.getUniqueNode()),s.createElement(r.default,{editorOneColumn:!0,pydio:n,mode:"edit",node:e,onDismiss:this.props.onDismiss})}});n.default=i,t.exports=n.default},{"./CompositeCard":9,"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],11:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("pydio/lang/observable")),a=r(e("../links/LinkModel")),l=r(e("../main/ShareHelper")),s=r(e("pydio/model/cell")),u=e("cells-sdk"),c=r(e("pydio"));function r(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(n);return e=r?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?h(t):e}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=c.default.requireLib("boot").moment,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,i["default"]);var e,t,n,r=y(o);function o(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),b(h(e=r.call(this)),"cells",void 0),b(h(e),"links",void 0),b(h(e),"edit",void 0),b(h(e),"node",void 0),b(h(e),"saving",void 0),e.cells=[],e.links=[],e.edit=t,e}return e=o,(t=[{key:"emptyLink",value:function(e){var t=this,n=new a.default,r=new u.TreeNode,o=l.default.getAuthorizations();r.Uuid=e.getMetadata().get("uuid"),n.getLink().Label=e.getLabel(),n.getLink().Description=pydio.MessageHash["share_center.257"].replace("%s",g(new Date).format("YYYY/MM/DD")),n.getLink().RootNodes.push(r);var i,r=[u.RestShareLinkAccessType.constructFromObject("Download")];return e.isLeaf()?(i="pydio_unique_dl",l.default.nodeHasEditor(pydio,e).preview&&!o.max_downloads?(i="pydio_unique_strip",r.push(u.RestShareLinkAccessType.constructFromObject("Preview"))):0<o.max_downloads&&(n.getLink().MaxDownloads=o.max_downloads)):(i="pydio_shared_folder",r.push(u.RestShareLinkAccessType.constructFromObject("Preview"))),n.getLink().ViewTemplateName=i,n.getLink().Permissions=r,o.max_expiration&&(n.getLink().AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(o.max_expiration)*60*24)),n.observe("update",function(){t.notify("update")}),n.observe("save",function(){t.updateUnderlyingNode()}),n}},{key:"createEmptyCell",value:function(){var e=this,t=new s.default(!0);t.setLabel(this.node.getLabel()),t.addRootNode(this.node),t.observe("update",function(){e.notify("update")}),t.dirty=!1,this.cells.push(t),this.notify("update")}},{key:"addToExistingCell",value:function(e){var t=this,n=new s.default(!0);n.observe("update",function(){t.notify("update")}),n.load(e).then(function(){n.addRootNode(t.node)});e=this.cells.filter(function(e){return!e.getUuid()});e.length&&this.removeNewCell(e[0]),this.cells.push(n)}},{key:"updateUnderlyingNode",value:function(){this.skipUpdateUnderlyingNode||c.default.getInstance().getContextHolder().requireNodeReload(this.node)}},{key:"deleteLink",value:function(e){var t=this;return e.deleteLink(this.emptyLink(this.node).getLink()).then(function(e){t.updateUnderlyingNode()})}},{key:"getNode",value:function(){return this.node}},{key:"load",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.node=e,this.cells=[],this.links=[],e.getMetadata().get("pydio_shares")&&JSON.parse(e.getMetadata().get("pydio_shares")).map(function(e){var t;3===e.Scope?((t=new a.default).observe("update",function(){n.notify("update")}),t.observe("save",function(){n.updateUnderlyingNode()}),t.load(e.UUID),n.links.push(t)):2===e.Scope&&((t=new s.default).observe("update",function(){n.notify("update")}),t.load(e.UUID),n.cells.push(t))}),this.edit&&!this.links.length&&this.links.push(this.emptyLink(e)),this.edit&&this.canCreateCells()&&!this.cells.length&&this.createEmptyCell(),t&&this.node.observe("node_replaced",function(){n.load(n.node,!1)})}},{key:"loadUniqueLink",value:function(e,t){var n=this;this.node=t;t=new a.default;return t.observe("update",function(){n.notify("update")}),t.load(e),this.links.push(t),t}},{key:"canCreateCells",value:function(){if(!this.node)return!1;var e=l.default.getAuthorizations(),t=this.node.isLeaf();return t&&e.file_workspaces||!t&&e.folder_workspaces}},{key:"save",value:function(){var n=this;this.saving=!0,this.notify("update");var t=[];this.cells.map(function(e){e.isDirty()&&t.push(e.save())}),this.links.map(function(e){e.isDirty()&&t.push(e.save())}),Promise.all(t).then(function(){var t=n.node.getMetadata().get("uuid");n.cells=n.cells.filter(function(e){return e.hasRootNode(t)}),n.updateUnderlyingNode(),n.saving=!1}).catch(function(e){n.updateUnderlyingNode(),n.saving=!1})}},{key:"deleteAll",value:function(){var t=this.node.getMetadata().get("uuid"),n=[];return this.cells.map(function(e){e.removeRootNode(t),n.push(e.save())}),this.links.map(function(e){n.push(e.deleteLink())}),Promise.all(n)}},{key:"removeNewCell",value:function(t){this.cells=this.cells.filter(function(e){return e!==t}),this.notify("update")}},{key:"revertChanges",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.cells=this.cells.filter(function(e){return e.getUuid()}),this.cells.map(function(e){e.isDirty()&&e.revertChanges()}),this.links.map(function(e){e.isDirty()&&e.revertChanges()}),!this.cells.length&&e&&this.canCreateCells()&&this.createEmptyCell(),this.notify("update")}},{key:"isDirty",value:function(){return!this.saving&&this.cells.filter(function(e){return e.isDirty()}).length||this.links.filter(function(e){return e.isDirty()}).length}},{key:"stopObserving",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.cells.map(function(e){e.stopObserving("update")}),this.links.map(function(e){e.stopObserving("update")}),p(m(o.prototype),"stopObserving",this).call(this,e,t)}},{key:"getCells",value:function(){if(this.node){var t=this.node.getMetadata().get("uuid");return this.cells.filter(function(e){return e.hasRootNode(t)})}return this.cells}},{key:"getLinks",value:function(){return this.links}}])&&f(e.prototype,t),n&&f(e,n),o}();n.default=e,t.exports=n.default},{"../links/LinkModel":18,"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/lang/observable":"pydio/lang/observable","pydio/model/cell":"pydio/model/cell"}],12:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("react")),a=r(e("pydio/http/resources-manager")),l=r(e("../main/ShareHelper")),p=(e("material-ui"),e("cells-sdk"));function r(e){return e&&e.__esModule?e:{default:e}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function c(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=r?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,i["default"].Component);var e,t,n,r=y(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,e)).state={mailerData:null},e}return e=o,(t=[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.subject,r=e.message,o=(e.users,e.linkModel),i=e.templateId;e.templateData;n||i?l.default.forceMailerOldSchool()?(n=encodeURIComponent(n),location.href="mailto:custom-email@domain.com?Subject="+n+"&Body="+r):a.default.loadClassesAndApply(["PydioMailer"],function(){t.setState({mailerData:c(c({},e),{},{enableIdentification:o&&o.getLink().TargetUsers,identifiedOnly:o&&o.getLink().RestrictToTargetUsers,crippleIdentificationKeys:!0})})}):this.setState({mailerData:null})}},{key:"toggleMailerData",value:function(e){this.setState({mailerData:c(c({},this.state.mailerData),e)})}},{key:"dismissMailer",value:function(){this.props.onDismiss()}},{key:"mailerProcessPost",value:function(e,n,i,a,t,l){var r=this.state.mailerData,o=r.crippleIdentificationKeys,s=r.identifiedOnly,u=r.linkModel,c=u.getLink();c.TargetUsers||(c.TargetUsers={}),c.RestrictToTargetUsers=s;var f={};Object.keys(n).forEach(function(e){var t=o?Math.random().toString(36).substring(7):e;c.TargetUsers[t]=p.RestShareLinkTargetUser.constructFromObject({Display:n[e].getLabel(),DownloadCount:0}),f[t]=e}),u.updateLink(c),u.save().then(function(){var n=new e,r=u.getPublicUrl(),o=new RegExp(r,"g");Object.keys(f).forEach(function(e){var t=a.replace(o,r+"?u="+e);n.addTarget(f[e],i,t)}),n.post(function(e){l(e)})})}},{key:"getMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";return this.props.pydio.MessageHash[t+(t?".":"")+e]}},{key:"render",value:function(){if(this.state.mailerData){var e,t=this.state.mailerData;return i.default.createElement(PydioMailer.Pane,s({},t,{onDismiss:this.dismissMailer.bind(this),overlay:!0,className:"share-center-mailer",panelTitle:this.props.pydio.MessageHash["share_center.45"],additionalPaneTop:e,processPost:t.enableIdentification?this.mailerProcessPost.bind(this):null,style:{width:420,margin:"0 auto"}}))}return null}}])&&f(e.prototype,t),n&&f(e,n),o}();n.default=e,t.exports=n.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk","material-ui":"material-ui","pydio/http/resources-manager":"pydio/http/resources-manager",react:"react"}],13:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=s(e("react")),r=s(e("./CompositeModel")),u=s(e("../cells/SharedUsers")),i=s(e("prop-types")),a=s(e("pydio")),l=e("material-ui/styles"),f=e("material-ui"),p=s(e("../main/ActionButton")),d=e("../links/Panel");function s(e){return e&&e.__esModule?e:{default:e}}function y(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function h(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?y(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function m(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=w(n);return e=r?(e=w(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(o,c["default"].Component);var e,t,n,r=O(o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var t=r.call(this,e),n=null;return 0===e.compositeModel.getCells().length&&(n="NEWCELL"),t.state={edit:n},t}return e=o,(t=[{key:"addToCellsMenuItems",value:function(e){var t,n,r,o=this,i=[],a=this.props,l=a.pydio,s=a.compositeModel,u=s.getCells().map(function(e){return e.getUuid()});return 0===u.filter(function(e){return!e}).length&&(i.push(c.default.createElement(f.MenuItem,{primaryText:e("cell.add.new"),onClick:function(){o.setState({addMenuOpen:!1}),s.createEmptyCell()},leftIcon:c.default.createElement(f.FontIcon,{className:"icomoon-cells-full-plus"})})),t=!0),l.user.getRepositoriesList().forEach(function(e){"shared"===e.getOwner()&&-1===u.indexOf(e.getId())&&(i.push(c.default.createElement(f.MenuItem,{primaryText:e.getLabel(),onClick:function(){o.setState({addMenuOpen:!1}),s.addToExistingCell(e.getId())},leftIcon:c.default.createElement(f.FontIcon,{className:"icomoon-cells"})})),n=!0)}),n&&t?r=e("cell.add.existing-or-new"):n?r=e("cell.add.existing"):t&&(r=e("cell.add.new")),{addItems:i,addLabel:r}}},{key:"removeCurrentNodeFromCell",value:function(t){var e=this.props.compositeModel;0===e.getCells().filter(function(e){return e!==t}).length&&e.createEmptyCell(),t.removeRootNode(e.getNode().getMetadata().get("uuid"))}},{key:"render",value:function(){function n(e){return o.MessageHash["share_center."+e]}var r=this,e=this.props,t=e.compositeModel,o=e.pydio,i=e.usersInvitations;e.muiTheme,this.state.edit;if(t.getNode()&&!t.canCreateCells())return c.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0, 0, 0, 0.43)",padding:8}},n(t.getNode().isLeaf()?"227":"228"));var a=1<t.getCells().length,l=[];t.getCells().map(function(t){var e=c.default.createElement("div",{style:{margin:"0 -10px"}},c.default.createElement(u.default,{pydio:o,cellAcls:t.getAcls(),excludes:[o.user.id],onUserObjectAdd:t.addUser.bind(t),onUserObjectRemove:t.removeUser.bind(t),onUserObjectUpdateRight:t.updateUserRight.bind(t),sendInvitations:function(e){return i(e,t)},saveSelectionAsTeam:!1,withActionLinks:function(e){return t.isEditable()?[].concat(m(e),[c.default.createElement(p.default,{mdiIcon:"delete-forever",destructive:!0,messageId:n("cells.remove.node"),callback:function(){r.removeCurrentNodeFromCell(t)}})]):e},readonly:!t.isEditable(),completerStyle:{margin:"-6px 8px 16px"}}));a?l.push(c.default.createElement(d.PaneToggler,{title:t.getLabel(),legend:t.getAclsSubjects()},e)):l.push(c.default.createElement("div",{style:{padding:16}},e)),l.push(c.default.createElement(f.Divider,null))}),l.pop();var s,e=this.addToCellsMenuItems(n),t=e.addItems,e=e.addLabel;return t.length&&(s=this.props.muiTheme,s=c.default.createElement("span",{id:"share-dialog-addtocell-menu"},c.default.createElement(f.FlatButton,{iconClassName:"icomoon-cells-full-plus",style:{width:"100%"},iconStyle:{color:s.palette.accent2Color},primary:!0,tooltip:n(263),label:e,tooltipPosition:"bottom-left",onClick:function(e){r.setState({addMenuOpen:!0,addMenuAnchor:e.currentTarget})}}),c.default.createElement(f.Popover,{open:this.state.addMenuOpen,anchorEl:this.state.addMenuAnchor,onRequestClose:function(){r.setState({addMenuOpen:!1})},anchorOrigin:{horizontal:"left",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"bottom"}},c.default.createElement(f.Menu,{desktop:!0,listStyle:{paddingTop:0},width:250},c.default.createElement(f.Subheader,null,e),t)))),c.default.createElement("div",{style:h(h({},this.props.style),{},{minHeight:300})},l,s&&c.default.createElement("div",{style:{position:"absolute",bottom:10,left:10}},s))}}])&&g(e.prototype,t),n&&g(e,n),o}();(n.default=e).PropTypes={pydio:i.default.instanceOf(a.default),compositeModel:i.default.instanceOf(r.default).isRequired,usersInvitations:i.default.func},n.default=e=(0,l.muiThemeable)()(e),t.exports=n.default},{"../cells/SharedUsers":7,"../links/Panel":19,"../main/ActionButton":26,"./CompositeModel":11,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio",react:"react"}],14:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=r(e("react")),i=r(e("../composite/CompositeModel")),u=r(e("../main/GenericEditor")),c=r(e("../links/Panel")),f=(r(e("../links/SecureOptions")),r(e("../main/ShareHelper"))),p=r(e("./Mailer")),d=(r(e("../links/PublicLinkTemplate")),r(e("../links/VisibilityPanel"))),y=r(e("../links/LabelPanel"));e("material-ui");function r(e){return e&&e.__esModule?e:{default:e}}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function l(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(n);return e=r?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=e("pydio").requireLib("hoc").PaletteModifier,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(o,s["default"].Component);var e,t,n,r=g(o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),e.editorOneColumn=!0;var t=r.call(this,e),e=new i.default(!0);return e.skipUpdateUnderlyingNode=!0,t.state={mode:t.props.mode||"view",model:e},t}return e=o,(t=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,r=t.linkUuid,o=t.onRemoveLink,t=this.state.model;t.observe("update",function(){e.forceUpdate()}),t.loadUniqueLink(r,n).observeOnce("delete",function(){o&&o()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"componentWillReceiveProps",value:function(e){e.LinkUuid&&e.LinkUuid!==this.props.LinkUuid&&this.state.model.loadUniqueLink(e.LinkUuid,e.node)}},{key:"linkInvitation",value:function(e){try{var t=f.default.prepareEmail(this.props.node,e);this.setState({mailerData:l(l({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){var e=this.state.model;try{e.getLinks().length&&e.getLinks()[0].save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){var e,t=this.props,n=t.node,r=t.pydio,o=t.editorOneColumn,i=this.state,a=i.model,l=i.mailerData,t=function(e){return r.MessageHash["share_center."+e]},i=(e=a.getLinks().length?a.getLinks()[0]:e)&&e.getLinkUuid()&&e.isEditable()?s.default.createElement("div",null,s.default.createElement(p.default,h({},l,{pydio:r,onDismiss:this.dismissMailer.bind(this)})),s.default.createElement(y.default,{pydio:r,linkModel:e,model:a})):s.default.createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},s.default.createElement(p.default,h({},l,{pydio:r,onDismiss:this.dismissMailer.bind(this)})),t(256).replace("%s",n.getLabel())),l={left:[],right:[],leftStyle:{padding:0}},n=a.getLinks();return e&&(l.left.push({Label:t(251),Value:"public-link",Component:s.default.createElement(c.default,{pydio:r,compositeModel:a,linkModel:n[0],showMailer:f.default.mailerSupported(r)?this.linkInvitation.bind(this):null})}),e.getLinkUuid()&&l.left.push({Label:t(253),Value:"link-visibility",Component:s.default.createElement(d.default,{pydio:r,linkModel:n[0]}),AlwaysLast:!0})),s.default.createElement(u.default,{tabs:l,pydio:r,header:i,saveEnabled:a.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){a.revertChanges()},editorOneColumn:o,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}}])&&m(e.prototype,t),n&&m(e,n),o}();n.default=e,n.default=e=O({primary1Color:"#009688"})(e),t.exports=n.default},{"../composite/CompositeModel":11,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":12,"material-ui":"material-ui",pydio:"pydio",react:"react"}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"CreateCellDialog",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"EditCellDialog",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"CellCard",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"SimpleLinkCard",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"InfoPanel",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"CompositeDialog",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"LinkModel",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"ShareHelper",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"ShareView",{enumerable:!0,get:function(){return f.ShareView}}),Object.defineProperty(n,"ShareViewModal",{enumerable:!0,get:function(){return f.ShareViewModal}});var r=p(e("./cells/CreateCellDialog")),o=p(e("./cells/EditCellDialog")),i=p(e("./cells/CellCard")),a=p(e("./composite/SimpleLinkCard")),l=p(e("./main/InfoPanel")),s=p(e("./composite/CompositeDialog")),u=p(e("./links/LinkModel")),c=p(e("./main/ShareHelper")),f=e("./lists/ShareView");function p(e){return e&&e.__esModule?e:{default:e}}},{"./cells/CellCard":2,"./cells/CreateCellDialog":3,"./cells/EditCellDialog":4,"./composite/CompositeDialog":10,"./composite/SimpleLinkCard":14,"./links/LinkModel":18,"./lists/ShareView":25,"./main/InfoPanel":28,"./main/ShareHelper":29}],16:[function(S,_,j){!function(P){!function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(j,"__esModule",{value:!0}),j.default=void 0;var l=y(S("react")),e=y(S("pydio")),t=y(S("prop-types")),n=y(S("../ShareContextConsumer")),s=(y(S("./TargetedUsers")),S("material-ui")),u=y(S("qrcode.react")),a=y(S("clipboard")),c=y(S("../main/ActionButton")),f=y(S("pydio/util/path")),p=y(S("pydio/util/lang")),r=S("material-ui/styles"),d=y(S("../main/ShareHelper")),i=y(S("./LinkModel"));function y(e){return e&&e.__esModule?e:{default:e}}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(n);return e=r?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?v(t):e}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=e.default.requireLib("hoc").ModernStyles,E=e.default.requireLib("boot").Tooltip,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(i,l["default"].Component);var e,t,n,o=g(i);function i(){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(v(r=o.call.apply(o,[this].concat(t))),"state",{editLink:!1,copyMessage:"",showQRCode:!1}),w(v(r),"toggleEditMode",function(){var e=r.props,t=e.linkModel,n=e.pydio;if(r.state.editLink&&r.state.customLink){e=d.default.getAuthorizations();if(e.hash_min_length&&r.state.customLink.length<e.hash_min_length)return void n.UI.displayMessage("ERROR",r.props.getMessage("223").replace("%s",e.hash_min_length));t.setCustomLink(r.state.customLink),t.save()}r.setState({editLink:!r.state.editLink,customLink:void 0})}),w(v(r),"changeLink",function(e){e=e.target.value,e=p.default.computeStringSlug(e);r.setState({customLink:e})}),w(v(r),"clearCopyMessage",function(){P.setTimeout(function(){this.setState({copyMessage:""})}.bind(v(r)),5e3)}),w(v(r),"attachClipboard",function(){var e=r.props,t=e.linkModel,n=e.pydio;r.detachClipboard(),r.refs["copy-button"]&&(r._clip=new a.default(r.refs["copy-button"],{text:function(e){return d.default.buildPublicUrl(n,t.getLink())}.bind(v(r))}),r._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(v(r))),r._clip.on("error",function(){var e=0===P.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("143");this.refs["public-link-field"].focus(),this.setState({copyMessage:e},this.clearCopyMessage)}.bind(v(r))))}),w(v(r),"detachClipboard",function(){r._clip&&r._clip.destroy()}),w(v(r),"openMailer",function(){r.props.showMailer(r.props.linkModel)}),w(v(r),"toggleQRCode",function(){r.setState({showQRCode:!r.state.showQRCode})}),r}return e=i,(t=[{key:"componentDidUpdate",value:function(e,t){this.attachClipboard()}},{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"confirmDisable",value:function(){var e=this.props.onDisableLink;confirm(this.props.getMessage("dialog.link.confirm.remove"))&&e()}},{key:"render",value:function(){var e=this,t=this.props,n=t.linkModel,r=t.pydio,o=d.default.buildPublicUrl(r,n.getLink()),i=d.default.getAuthorizations(),a=this.props.editAllowed&&i.editable_hash&&!this.props.isReadonly()&&n.isEditable();if(this.state.editLink&&a)return l.default.createElement("div",null,l.default.createElement("div",{style:{display:"flex",alignItems:"center",backgroundColor:"rgb(246, 246, 248)",padding:6,borderRadius:2}},l.default.createElement("span",{style:{fontSize:16,color:"rgba(0,0,0,0.4)",display:"inline-block",maxWidth:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},f.default.getDirname(o)+"/ "),l.default.createElement(s.TextField,{style:{flex:1,marginRight:10,marginLeft:10},onChange:this.changeLink,value:void 0!==this.state.customLink?this.state.customLink:n.getLink().LinkHash}),l.default.createElement(c.default,{mdiIcon:"check",callback:this.toggleEditMode})),l.default.createElement("div",{style:{textAlign:"center",fontSize:13,color:"rgba(0,0,0,0.43)",paddingTop:16}},this.props.getMessage("194")));t=this.state,r=t.copyMessage,i=t.linkTooltip,function(){return{__html:this.state.copyMessage}}.bind(this),n=[],t=this.props.muiTheme,t=l.default.createElement("div",{key:"copy",ref:"copy-button",style:{position:"absolute",right:0,bottom:7,width:30,height:30,padding:4,backgroundColor:"#f6f6f8",fontSize:16,cursor:"pointer"},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},l.default.createElement(E,{label:r||this.props.getMessage("191"),horizontalPosition:"left",verticalPosition:"bottom",show:i}),l.default.createElement("span",{className:"copy-link-button mdi mdi-content-copy",style:{color:t.palette.primary1Color}}));return this.props.showMailer&&n.push(l.default.createElement(c.default,{key:"outline",callback:this.openMailer,mdiIcon:"email-outline",messageId:"45"})),a&&n.push(l.default.createElement(c.default,{key:"pencil",callback:this.toggleEditMode,mdiIcon:"pencil",messageId:"193"})),d.default.qrcodeEnabled()&&n.push(l.default.createElement(c.default,{key:"qrcode",callback:this.toggleQRCode,mdiIcon:"qrcode",messageId:"94"})),this.props.onDisableLink&&n.push(l.default.createElement(c.default,{key:"delete",destructive:!0,callback:function(){return e.confirmDisable()},mdiIcon:"link-off",messageId:"link.disable"})),n=n.length?l.default.createElement("div",{style:{display:"flex",marginTop:10}},l.default.createElement("span",{style:{flex:1}}),n,l.default.createElement("span",{style:{flex:1}})):null,a=this.state.showQRCode?l.default.createElement(s.Paper,{zDepth:1,style:{width:120,paddingTop:10,overflow:"hidden",margin:"0 auto",height:120,textAlign:"center"}},l.default.createElement(u.default,{size:100,value:o,level:"Q"})):l.default.createElement(s.Paper,{zDepth:0,style:{width:120,overflow:"hidden",margin:"0 auto",height:0,textAlign:"center"}}),l.default.createElement(s.Paper,{zDepth:0,rounded:!1,className:"public-link-container"},l.default.createElement("div",{style:{marginTop:-8,position:"relative"}},l.default.createElement(s.TextField,h({floatingLabelText:this.props.getMessage("link.floatingLabel"),floatingLabelFixed:!0,type:"text",name:"Link",ref:"public-link-field",value:o,onFocus:function(e){e.target.select()},fullWidth:!0},k.textFieldV2)),t),!1,n,a)}}])&&m(e.prototype,t),n&&m(e,n),i}();w(j.default=e,"propTypes",{linkModel:t.default.instanceOf(i.default),editAllowed:t.default.bool,onChange:t.default.func,showMailer:t.default.func}),j.default=e=(0,r.muiThemeable)()(e),j.default=e=(0,n.default)(e),_.exports=j.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../main/ActionButton":26,"../main/ShareHelper":29,"./LinkModel":18,"./TargetedUsers":23,clipboard:"clipboard","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/util/lang":"pydio/util/lang","pydio/util/path":"pydio/util/path","qrcode.react":"qrcode.react",react:"react"}],17:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.LinkLabelTitle=function(e,t,n){return{title:n("265"),legend:t.getLink().Label}},n.default=void 0;var s=f(e("react")),r=f(e("prop-types")),i=f(e("pydio")),a=f(e("./LinkModel")),u=f(e("../main/ShareHelper")),c=f(e("./PublicLinkTemplate")),l=f(e("../ShareContextConsumer"));function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=r?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=i.default.requireLib("hoc").ModernTextField;e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,s["default"].Component);var e,t,n,r=y(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"render",value:function(){var e,t=this.props,n=t.pydio,r=t.model,o=t.linkModel,i=t.style,a=t.showLayout,t=function(e){return n.MessageHash["share_center."+e]},l=o.getLink(),r=u.default.compileLayoutData(n,r);return a&&1<r.length&&(e=s.default.createElement(c.default,{linkModel:o,pydio:n,layoutData:r,hideTitle:!0})),s.default.createElement("div",{style:i},s.default.createElement(m,{variant:"v2",floatingLabelText:t(265),value:l.Label,onChange:function(e,t){l.Label=t,o.updateLink(l)},fullWidth:!0}),s.default.createElement(m,{variant:"v2",floatingLabelText:t(266),value:l.Description,onChange:function(e,t){l.Description=t,o.updateLink(l)},fullWidth:!0}),e)}}])&&p(e.prototype,t),n&&p(e,n),o}();n.default=e,n.default=e=(0,l.default)(e),e.PropTypes={pydio:r.default.instanceOf(i.default),linkModel:r.default.instanceOf(a.default)}},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"./PublicLinkTemplate":21,"prop-types":"prop-types",pydio:"pydio",react:"react"}],18:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=i(e("pydio")),l=i(e("pydio/http/api")),r=i(e("pydio/lang/observable")),s=i(e("../main/ShareHelper")),u=e("cells-sdk"),c=i(e("pydio/util/pass"));function i(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(n);return e=r?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?y(t):e}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(i,r["default"]);var e,t,n,o=d(i);function i(){var e,t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=o.call(this),t=y(e),r=void 0,(n="dirty")in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,e.link=new u.RestShareLink,e.link.Permissions=[u.RestShareLinkAccessType.constructFromObject("Preview"),u.RestShareLinkAccessType.constructFromObject("Download")],e.link.Policies=[],e.link.PoliciesContextEditable=!0,e.link.RootNodes=[],e.ValidPassword=!0,e.loadError=null,e}return e=i,(t=[{key:"hasError",value:function(){return this.loadError}},{key:"isEditable",value:function(){return this.link.PoliciesContextEditable}},{key:"isDirty",value:function(){return this.dirty}},{key:"getLinkUuid",value:function(){return this.link.Uuid}},{key:"getLink",value:function(){return this.link}},{key:"getPublicUrl",value:function(){return s.default.buildPublicUrl(a.default.getInstance(),this.link)}},{key:"updateLink",value:function(e){this.link=e,this.notifyDirty()}},{key:"notifyDirty",value:function(){this.dirty=!0,this.notify("update")}},{key:"revertChanges",value:function(){this.originalLink&&(this.link=this.clone(this.originalLink),this.dirty=!1,this.updatePassword=this.createPassword=null,this.ValidPassword=!0,this.notify("update"))}},{key:"hasPermission",value:function(t){return 0<this.link.Permissions.filter(function(e){return e===t}).length}},{key:"isExpired",value:function(){return!!(this.link.MaxDownloads&&parseInt(this.link.CurrentDownloads)>=parseInt(this.link.MaxDownloads))||(this.link.AccessEnd,!1)}},{key:"load",value:function(e){var t=this;return new u.ShareServiceApi(l.default.getRestClient()).getShareLink(e).then(function(e){t.link=e,t.link.Permissions||(t.link.Permissions=[]),t.link.Policies||(t.link.Policies=[]),t.link.RootNodes||(t.link.RootNodes=[]),t.originalLink=t.clone(t.link),t.notify("update")}).catch(function(e){t.loadError=e,t.notify("update")})}},{key:"setCreatePassword",value:function(e){var n=this;e?c.default.checkPasswordStrength(e,function(e,t){n.ValidPassword=e,n.ValidPasswordMessage=t}):this.ValidPassword=!0,this.createPassword=e,this.link.PasswordRequired=!0,this.notifyDirty()}},{key:"setUpdatePassword",value:function(e){var n=this;e?c.default.checkPasswordStrength(e,function(e,t){n.ValidPassword=e,n.ValidPasswordMessage=t}):this.ValidPassword=!0,this.updatePassword=e,this.notifyDirty()}},{key:"setCustomLink",value:function(e){this.customLink=e}},{key:"save",value:function(){var t=this;if(!this.ValidPassword)throw new Error(this.ValidPasswordMessage);var e=new u.ShareServiceApi(l.default.getRestClient()),n=new u.RestPutShareLinkRequest;this.createPassword?(n.PasswordEnabled=!0,n.CreatePassword=this.createPassword):this.updatePassword?(n.PasswordEnabled=!0,this.link.PasswordRequired?n.UpdatePassword=this.updatePassword:n.CreatePassword=this.updatePassword):n.PasswordEnabled=this.link.PasswordRequired;var r=s.default.getAuthorizations();if(r.password_mandatory&&!n.PasswordEnabled)throw new Error(a.default.getMessages()["share_center.175"]);return 0<parseInt(r.max_downloads)&&!parseInt(this.link.MaxDownloads)&&(this.link.MaxDownloads=""+parseInt(r.max_downloads),this.notify("update")),0<parseInt(r.max_expiration)&&!parseInt(this.link.AccessEnd)&&(this.link.AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(r.max_expiration)*60*24),this.notify("update")),this.customLink&&this.customLink!==this.link.LinkHash&&(n.UpdateCustomHash=this.customLink),n.ShareLink=this.link,e.putShareLink(n).then(function(e){t.link=e,t.dirty=!1,t.originalLink=t.clone(t.link),t.updatePassword=t.createPassword=t.customLink=null,t.ValidPassword=!0,t.notify("update"),t.notify("save")}).catch(function(e){e=e.Detail||e.message||e;a.default.getInstance().UI.displayMessage("ERROR",e)})}},{key:"deleteLink",value:function(t){var n=this;return new u.ShareServiceApi(l.default.getRestClient()).deleteShareLink(this.link.Uuid).then(function(e){n.link=t,n.dirty=!1,n.updatePassword=n.createPassword=n.customLink=null,n.notify("update"),n.notify("delete")}).catch(function(e){e=e.Detail||e.message||e;pydio.UI.displayMessage("ERROR",e)})}},{key:"clone",value:function(e){return u.RestShareLink.constructFromObject(JSON.parse(JSON.stringify(e)))}}])&&f(e.prototype,t),n&&f(e,n),i}();n.default=e,t.exports=n.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable","pydio/util/pass":"pydio/util/pass"}],19:[function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.PaneToggler=void 0;var h=f(e("react")),r=f(e("../ShareContextConsumer")),m=f(e("./Field")),b=c(e("./Permissions")),g=f(e("./TargetedUsers")),v=e("material-ui"),o=f(e("./LinkModel")),i=f(e("../composite/CompositeModel")),l=f(e("prop-types")),s=f(e("pydio")),O=f(e("../main/ShareHelper")),w=c(e("./SecureOptions"));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=i?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=e[n]);return o.default=e,t&&t.set(e,o),o}function f(e){return e&&e.__esModule?e:{default:e}}function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach(function(e){y(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&P(e.prototype,t),n&&P(e,n),e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=L(n);return e=r?(e=L(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==a(e)&&"function"!=typeof e?C(t):e}}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=s.default.requireLib("form").ValidPassword,x=s.default.requireLib("hoc").ModernStyles,T=function(){_(r,h["default"].Component);var n=M(r);function r(e){var t;return E(this,r),(t=n.call(this,e)).state={active:!!e.active},t}return S(r,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,r=t.legend,o=t.children,i=this.state.active,t={title:{cursor:"pointer",fontSize:15,padding:16,paddingBottom:i?8:16,display:"flex",alignItems:"center",fontWeight:i?500:null},legend:{opacity:.4,fontSize:12,fontWeight:500,fontStyle:"italic"},content:{padding:"0 16px 8px"},chevron:{fontSize:24,color:"rgba(0,0,0,.3)",transition:"transform 250ms ease",transform:i?"rotate(90deg)":""}};return h.default.createElement(h.default.Fragment,null,h.default.createElement("div",{style:d({},t.title),onClick:function(){e.setState({active:!i})}},h.default.createElement("span",{style:{flex:1}},n,r&&h.default.createElement("span",{style:t.legend}," - ",r)),h.default.createElement("span",{className:"mdi mdi-chevron-right",style:t.chevron})),i&&h.default.createElement("div",{style:d({},t.content)},o))}}]),r}();n.PaneToggler=T;e=function(){_(i,h["default"].Component);var o=M(i);function i(){var n;E(this,i);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return y(C(n=o.call.apply(o,[this].concat(t))),"state",{showTemporaryPassword:!1,temporaryPassword:null,saving:!1}),y(C(n),"toggleLink",function(){var e=n.props,t=e.linkModel;e.pydio;n.state.showTemporaryPassword?n.setState({showTemporaryPassword:!1,temporaryPassword:null}):!t.getLinkUuid()&&O.default.getAuthorizations().password_mandatory?n.setState({showTemporaryPassword:!0,temporaryPassword:""}):(n.setState({saving:!0}),(t.getLinkUuid()?n.props.compositeModel.deleteLink(t):t.save()).catch(function(){n.setState({saving:!1})}).then(function(){n.setState({saving:!1})}))}),y(C(n),"updateTemporaryPassword",function(e,t){void 0===e&&(e=t.currentTarget.getValue()),n.setState({temporaryPassword:e})}),y(C(n),"enableLinkWithPassword",function(){var e=n.props.linkModel;if(n.state.temporaryPasswordState){e.setCreatePassword(n.state.temporaryPassword);try{e.save()}catch(e){n.props.pydio.UI.displayMessage("ERROR",e.message)}n.setState({showTemporaryPassword:!1,temporaryPassword:null})}else n.props.pydio.UI.displayMessage("ERROR","Invalid Password")}),n}return S(i,[{key:"render",value:function(){var t,e,n=this,r=this.props,o=r.linkModel,i=r.pydio,a=r.compositeModel,l=r.toggleOnly,s=r.additionalPanes,u=this.state,c=u.showTemporaryPassword,f=u.temporaryPassword,p=u.saving,d=O.default.getAuthorizations(),r=a.getNode().isLeaf(),u=r&&d.file_public_link||!r&&d.folder_public_link,y={backgroundColor:"#eee"};return o.getLinkUuid()?(this.props.isReadonly()||p||!o.isEditable()||!o.getLinkUuid()&&!u||(e=function(){return n.toggleLink()}),e=h.default.createElement(m.default,{pydio:i,linkModel:o,showMailer:this.props.showMailer,editAllowed:d.editable_hash&&o.isEditable(),onDisableLink:e,key:"public-link"}),t=[h.default.createElement(v.Divider,{style:y}),h.default.createElement(T,(0,b.PermissionsTitle)(a,o,this.props.getMessage),h.default.createElement(b.default,{compositeModel:a,linkModel:o,pydio:i,key:"public-perm"}))],o.getLink().TargetUsers&&(t.push(h.default.createElement(v.Divider,{style:y})),t.push(h.default.createElement(g.default,{linkModel:o,pydio:i}))),t.push(h.default.createElement(v.Divider,{style:y})),t.push(h.default.createElement(T,(0,w.SecureOptionsTitle)(a,o,this.props.getMessage),h.default.createElement(w.default,{pydio:i,linkModel:o}))),s&&s.forEach(function(e){t.push(h.default.createElement(v.Divider,{style:y})),t.push(h.default.createElement(T,{title:e.title,legend:e.legend},e.content))})):e=c?h.default.createElement("div",null,h.default.createElement("div",{className:"section-legend",style:{marginTop:20}},this.props.getMessage("215")),h.default.createElement("div",{style:{width:"100%"}},h.default.createElement(R,{attributes:{label:this.props.getMessage("23")},value:f,onChange:this.updateTemporaryPassword.bind(this),onValidStatusChange:function(e){return n.setState({temporaryPasswordState:e})},variant:"v2"})),h.default.createElement("div",{style:{textAlign:"center",marginTop:20}},h.default.createElement(v.RaisedButton,{label:this.props.getMessage("92"),secondary:!0,onClick:this.enableLinkWithPassword.bind(this),disabled:!this.state.temporaryPasswordState}))):u?h.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage("190")):h.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage(r?"225":"226")),h.default.createElement("div",{style:this.props.style},!(o.getLinkUuid()||c)&&h.default.createElement("div",{style:{padding:16}},h.default.createElement(v.Toggle,k({disabled:this.props.isReadonly()||p||!o.isEditable()||!o.getLinkUuid()&&!u,onToggle:this.toggleLink,toggled:o.getLinkUuid()||c,label:this.props.getMessage("189")},x.toggleFieldV2))),p&&h.default.createElement("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"}},h.default.createElement(v.CircularProgress,null)),!l&&!p&&h.default.createElement("div",{style:{padding:16}},e),!l&&!p&&t)}}]),i}();y(n.default=e,"propTypes",{linkModel:l.default.instanceOf(o.default),compositeModel:l.default.instanceOf(i.default),pydio:l.default.instanceOf(s.default),authorizations:l.default.object,showMailer:l.default.func}),n.default=e=(0,r.default)(e)},{"../ShareContextConsumer":1,"../composite/CompositeModel":11,"../main/ShareHelper":29,"./Field":16,"./LinkModel":18,"./Permissions":20,"./SecureOptions":22,"./TargetedUsers":23,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],20:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.PermissionsTitle=function(e,t,n){var r,o=[];t.hasPermission("Preview")&&o.push(n("72"));t.hasPermission("Download")&&o.push(n("73"));t.hasPermission("Upload")&&(e.getNode().isLeaf()?o.push(n("74b")):o.push(n("74")));o.length&&(r=o.join(", ").toLowerCase());return{title:n("71"),legend:r}},n.default=void 0;var i=f(e("react")),r=f(e("prop-types")),a=(f(e("pydio")),f(e("../ShareContextConsumer"))),l=e("material-ui"),s=f(e("./LinkModel")),u=f(e("../main/ShareHelper")),c=e("cells-sdk");function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(n);return e=r?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?h(t):e}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,i["default"].Component);var e,t,n,r=y(o);function o(){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return b(h(i=r.call.apply(r,[this].concat(t))),"changePermission",function(e){var t=e.target.name,n=e.target.checked,r=i.props,o=r.compositeModel,e=r.linkModel,r=e.getLink();n?r.Permissions.push(c.RestShareLinkAccessType.constructFromObject(t)):r.Permissions=r.Permissions.filter(function(e){return e!==t}),o.getNode().isLeaf()&&(o=u.default.getAuthorizations().max_downloads,e.hasPermission("Preview")?(r.ViewTemplateName="pydio_unique_strip",r.MaxDownloads=0):(r.ViewTemplateName="pydio_unique_dl",o&&!r.MaxDownloads&&(r.MaxDownloads=o))),i.props.linkModel.updateLink(r)}),i}return e=o,(t=[{key:"render",value:function(){var e=this.props,t=e.linkModel,n=e.compositeModel,r=e.pydio,o=n.getNode(),e=[],n=u.default.getAuthorizations();return o.isLeaf()?(o=(r=u.default.nodeHasEditor(r,o)).preview,r=r.writeable,e.push({NAME:"Download",LABEL:this.props.getMessage("73"),DISABLED:!o||!t.hasPermission("Preview")}),o&&!n.max_downloads&&(e.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Download")}),t.hasPermission("Preview")&&r&&e.push({NAME:"Upload",LABEL:this.props.getMessage("74b")}))):(e.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Upload")}),e.push({NAME:"Download",LABEL:this.props.getMessage("73")}),e.push({NAME:"Upload",LABEL:this.props.getMessage("74")})),i.default.createElement("div",null,e.map(function(e){return i.default.createElement(l.Checkbox,{key:e.NAME,disabled:e.DISABLED||this.props.isReadonly()||!t.isEditable(),type:"checkbox",name:e.NAME,label:e.LABEL,onCheck:this.changePermission,checked:t.hasPermission(e.NAME),labelStyle:{whiteSpace:"nowrap"},style:{margin:"10px 0"}})}.bind(this)),void 0)}}])&&p(e.prototype,t),n&&p(e,n),o}();b(n.default=e,"propTypes",{linkModel:r.default.instanceOf(s.default),style:r.default.object}),n.default=e=(0,a.default)(e)},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"cells-sdk":"cells-sdk","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],21:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=u(e("react")),r=u(e("prop-types")),a=u(e("pydio")),l=u(e("../ShareContextConsumer")),s=e("material-ui"),e=u(e("./LinkModel"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(n);return e=r?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=a.default.requireLib("hoc").ModernSelectField,a=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,i["default"].Component);var e,t,n,r=p(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"onDropDownChange",value:function(e,t,n){var r=this.props.linkModel;r.getLink().ViewTemplateName=n,r.notifyDirty()}},{key:"render",value:function(){var t,e=this.props,n=e.linkModel,r=e.hideTitle,o=n.getLink().ViewTemplateName,e=this.props.layoutData.map(function(e){return o&&e.LAYOUT_ELEMENT===o&&(t=e.LAYOUT_LABEL),o||t||(o=e.LAYOUT_ELEMENT,t=e.LAYOUT_LABEL),i.default.createElement(s.MenuItem,{key:e.LAYOUT_ELEMENT,value:e.LAYOUT_ELEMENT,primaryText:e.LAYOUT_LABEL})});return i.default.createElement("div",{style:this.props.style},!r&&i.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},this.props.getMessage("151")),i.default.createElement(y,{variant:"v2",fullWidth:!0,value:o,onChange:this.onDropDownChange.bind(this),disabled:this.props.isReadonly()||this.props.readonly||!n.isEditable(),floatingLabelText:this.props.getMessage("151")},e))}}])&&c(e.prototype,t),n&&c(e,n),o}();a.PropTypes={linkModel:r.default.instanceOf(e.default)};a=(0,l.default)(a);n.default=a,t.exports=n.default},{"../ShareContextConsumer":1,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],22:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.SecureOptionsTitle=function(e,t,n){n("link.secure.title");var r,o,i=[],a=t.getLink();{var l,s;a.AccessEnd&&0!==parseInt(a.AccessEnd)&&(l=new Date(1e3*parseInt(a.AccessEnd)),s=new Date,t=n("link.secure.expires"),l<s&&(t=n("link.secure.expired"),r=y.default.createElement("span",{className:"mdi mdi-alert"})),i.push(t+" "+S(l).fromNow()))}a.PasswordRequired&&i.push(n("link.secure.hasPassword"));0<a.MaxDownloads&&i.push(n("link.secure.maxdownloads").replace("%d",a.MaxDownloads));i.length&&(o=y.default.createElement(y.default.Fragment,null,r,i.join(", ")));return{title:n("link.secure.title"),legend:o}},n.default=void 0;var y=u(e("react")),r=u(e("prop-types")),l=u(e("pydio")),i=u(e("pydio/util/pass")),h=e("material-ui"),a=u(e("../ShareContextConsumer")),s=u(e("./LinkModel")),m=u(e("../main/ShareHelper"));function u(e){return e&&e.__esModule?e:{default:e}}function c(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach(function(e){w(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(n);return e=r?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?v(t):e}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=l.default.requireLib("form").ValidPassword,e=l.default.requireLib("hoc"),E=e.ModernTextField,P=e.ModernStyles,S=l.default.requireLib("boot").moment,_={iconButton:{style:{width:40,height:40,padding:6},iconStyle:{color:"rgba(0,0,0,.5)",fontSize:20}},leftIcon:{margin:"0 16px 0 4px",color:"#757575"}};e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,y["default"].Component);var e,t,n,r=d(o);function o(){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(v(a=r.call.apply(r,[this].concat(t))),"state",{}),w(v(a),"updateDLExpirationField",function(e){var t=e.currentTarget.value;parseInt(t)<0&&(t=-parseInt(t));var n=a.props.linkModel,e=n.getLink();e.MaxDownloads=t,n.updateLink(e)}),w(v(a),"updateDaysExpirationField",function(e,t){t=t||e.currentTarget.getValue();var n=a.props.linkModel,e=n.getLink();e.AccessEnd=t,n.updateLink(e)}),w(v(a),"onDateChange",function(e,t){t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());a.updateDaysExpirationField(e,Math.floor(t/1e3)+"")}),w(v(a),"resetPassword",function(){var e=a.props.linkModel;e.setUpdatePassword(""),e.getLink().PasswordRequired=!1,e.notifyDirty()}),w(v(a),"setUpdatingPassword",function(n){i.default.checkPasswordStrength(n,function(e,t){a.setState({updatingPassword:n,updatingPasswordValid:e})})}),w(v(a),"changePassword",function(){var e=a.props.linkModel,t=a.state.updatingPassword;e.setUpdatePassword(t),a.setState({pwPop:!1,updatingPassword:"",updatingPasswordValid:!1}),e.notifyDirty()}),w(v(a),"updatePassword",function(e,t){var n=a.props.linkModel;a.state.validPasswordStatus?a.setState({invalidPassword:null,invalid:!1},function(){n.setUpdatePassword(e)}):a.setState({invalidPassword:e,invalid:!0})}),w(v(a),"resetDownloads",function(){var e;window.confirm(a.props.getMessage("106"))&&((e=a.props.linkModel).getLink().CurrentDownloads="0",e.notifyDirty())}),w(v(a),"resetExpiration",function(){var e=a.props.linkModel;e.getLink().AccessEnd="0",e.notifyDirty()}),w(v(a),"renderPasswordContainer",function(){var e,t,n,r=a.props.linkModel,o=r.getLink(),i=m.default.getAuthorizations();return o.PasswordRequired?(a.props.isReadonly()||!r.isEditable()||i.password_mandatory||(t=y.default.createElement(h.IconButton,g({iconClassName:"mdi mdi-close-circle",onClick:a.resetPassword,tooltip:a.props.getMessage("174")},_.iconButton))),!a.props.isReadonly()&&r.isEditable()&&(n=y.default.createElement("div",null,y.default.createElement(h.IconButton,g({iconClassName:"mdi mdi-pencil",onClick:function(e){a.setState({pwPop:!0,pwAnchor:e.currentTarget})},tooltip:a.props.getMessage("181")},_.iconButton)),y.default.createElement(h.Popover,{open:a.state.pwPop,anchorEl:a.state.pwAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){a.setState({pwPop:!1})}},y.default.createElement("div",{style:{width:380,padding:8}},y.default.createElement(k,{name:"update",ref:"pwdUpdate",attributes:{label:a.props.getMessage("23")},value:a.state.updatingPassword||"",onChange:function(e){a.setUpdatingPassword(e)},onValidStatusChange:function(e){return a.setState({updatingPasswordDiffer:!e})},variant:"v2"}),y.default.createElement("div",{style:{paddingTop:20,textAlign:"right"}},y.default.createElement(h.FlatButton,{label:l.default.getMessages()[54],onClick:function(){a.setState({pwPop:!1,updatingPassword:""})}}),y.default.createElement(h.FlatButton,{style:{minWidth:60},label:l.default.getMessages()[48],onClick:function(){a.changePassword()},disabled:!a.state.updatingPassword||!a.state.updatingPasswordValid||a.state.updatingPasswordDiffer})))))),e=y.default.createElement(E,{floatingLabelText:a.props.getMessage("23"),disabled:!0,value:"********",fullWidth:!0,variant:"v2"})):!a.props.isReadonly()&&r.isEditable()&&(e=y.default.createElement(k,{name:"share-password",ref:"pwd",attributes:{label:a.props.getMessage("23")},value:a.state.invalidPassword||r.updatePassword,onChange:a.updatePassword.bind(v(a)),onValidStatusChange:function(e){a.setState({validPasswordStatus:e})},variant:"v2"})),e?y.default.createElement("div",{className:"password-container",style:{display:"flex",alignItems:"baseline",width:"100%",position:"relative"}},y.default.createElement("div",{style:{width:"100%",display:"inline-block"}},e),(t||n)&&y.default.createElement("div",{style:{position:"absolute",right:0,bottom:0,display:"flex"}},n,t)):null}),w(v(a),"formatDate",function(e){return a.props.getMessage("date_format","").split(" ").shift().replace("Y",e.getFullYear()).replace("m",e.getMonth()+1).replace("d",e.getDate())}),a}return e=o,(t=[{key:"render",value:function(){var e,t,n,r,o=this.props.linkModel,i=o.getLink(),a=this.renderPasswordContainer(),l=o.hasPermission("Download")&&!o.hasPermission("Preview")&&!o.hasPermission("Upload"),s=parseInt(i.MaxDownloads),u=parseInt(i.AccessEnd),c=!1,f=!1,p=new Date,d=m.default.getAuthorizations();return 0<parseInt(d.max_expiration)&&(n=new Date).setDate(p.getDate()+parseInt(d.max_expiration)),0<parseInt(d.max_downloads)&&(s=Math.max(1,Math.min(s,parseInt(d.max_downloads)))),u&&(u<0&&(c=!0),t=new Date(1e3*u),parseInt(d.max_expiration)||(e=y.default.createElement(h.IconButton,{iconStyle:_.iconButton.iconStyle,style:b(b({},_.iconButton.style),{},{position:"absolute",right:0,bottom:0,zIndex:1}),iconClassName:"mdi mdi-close-circle",onClick:this.resetExpiration.bind(this)}))),s&&((i=parseInt(i.CurrentDownloads)||0)&&(r=y.default.createElement("a",{style:{cursor:"pointer"},onClick:this.resetDownloads.bind(this),title:this.props.getMessage("17")},"(",this.props.getMessage("16"),")"),s<=i&&(f=!0)),r=y.default.createElement("span",{className:"dlCounterString"},i+"/"+s," ",r)),y.default.createElement("div",null,a,y.default.createElement("div",{style:{display:"flex",alignItems:"baseline",position:"relative"},className:c?"limit-block-expired":null},y.default.createElement(h.DatePicker,g({ref:"expirationDate",key:"start",value:t,minDate:new Date,maxDate:n,autoOk:!0,disabled:this.props.isReadonly()||!o.isEditable(),onChange:this.onDateChange,showYearSelector:!0,floatingLabelText:this.props.getMessage(c?"21b":"21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},P.textFieldV2,{style:{flex:1},textFieldStyle:b(b({},P.textFieldV2.style),{},{flex:1})})),e),y.default.createElement("div",{style:{alignItems:"baseline",display:l?"flex":"none",position:"relative"},className:f?"limit-block-expired":null},y.default.createElement(E,{type:"number",disabled:this.props.isReadonly()||!o.isEditable(),floatingLabelText:this.props.getMessage(f?"22b":"22"),value:0<s?s:"",onChange:this.updateDLExpirationField,fullWidth:!0,style:{flex:1},variant:"v2"}),y.default.createElement("span",{style:{position:"absolute",right:10,top:14,fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},r)))}}])&&f(e.prototype,t),n&&f(e,n),o}();w(n.default=e,"propTypes",{linkModel:r.default.instanceOf(s.default).isRequired,style:r.default.object}),n.default=e=(0,a.default)(e)},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],23:[function(w,k,E){!function(O){!function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var e=s(w("prop-types")),i=s(w("react")),r=s(w("react-dom")),t=s(w("../ShareContextConsumer")),a=w("material-ui"),l=s(w("clipboard")),n=s(w("../links/LinkModel"));function s(e){return e&&e.__esModule?e:{default:e}}function u(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function c(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(n);return e=r?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(){y(n,i["default"].Component);var t=m(n);function n(e){return f(this,n),(e=t.call(this,e)).state={copyMessage:""},e}return d(n,[{key:"componentDidMount",value:function(){this._clip&&this._clip.destroy(),this._button&&(this._clip=new l.default(this._button,{text:function(e){return this.props.link}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var e=0===O.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("share_center.143");this.setState({copyMessage:e},this.clearCopyMessage)}.bind(this)))}},{key:"componentWillUnmount",value:function(){this._clip&&this._clip.destroy()}},{key:"clearCopyMessage",value:function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(this),5e3)}},{key:"render",value:function(){var t=this,e=this.props,n=e.targetUser,e=e.link;return i.default.createElement("div",{style:{display:"flex"}},i.default.createElement("div",{style:{flex:1}},n.Display,i.default.createElement(a.IconButton,{pydio:this.props.pydio,ref:function(e){t._button=r.default.findDOMNode(e)},iconClassName:"mdi mdi-link",tooltip:this.state.copyMessage||e,iconStyle:{fontSize:13,lineHeight:"17px"},style:{width:34,height:34,padding:6}})),i.default.createElement("div",{style:{width:40,textAlign:"center"}},n.DownloadCount))}}]),n}(),v=function(){y(r,i["default"].Component);var n=m(r);function r(e,t){return f(this,r),(t=n.call(this,e,t)).state={open:!1},t}return d(r,[{key:"render",value:function(){var n,e=this,r=this.props.linkModel,t=r.getLink();t.TargetUsers&&(n=t.TargetUsers);var o=Object.keys(n).map(function(e){var t=r.getPublicUrl()+"?u="+e;return i.default.createElement(g,{targetUser:n[e],link:t})});if(!o.length)return null;t={borderBottom:this.state.open?"1px solid #757575":"",color:"rgba(0, 0, 0, 0.36)"};return i.default.createElement("div",{style:{lineHeight:"34px",padding:"4px 10px 4px",fontSize:14,backgroundColor:"#fafafa",borderRadius:2}},i.default.createElement("div",{style:c({display:"flex"},t)},i.default.createElement("div",{style:{flex:1}},this.props.getMessage("245").replace("%s",o.length)," ",i.default.createElement("span",{className:"mdi mdi-chevron-"+(this.state.open?"up":"down"),style:{cursor:"pointer"},onClick:function(){e.setState({open:!e.state.open})}})),this.state.open&&i.default.createElement("div",{style:{width:40,textAlign:"center"}},"#DL")),this.state.open&&i.default.createElement("div",null,o))}}]),r}();(E.default=v).propTypes={linkModel:e.default.instanceOf(n.default)},E.default=v=(0,t.default)(v),g=(0,t.default)(g),k.exports=E.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../links/LinkModel":18,clipboard:"clipboard","material-ui":"material-ui","prop-types":"prop-types",react:"react","react-dom":"react-dom"}],24:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=f(e("react")),r=f(e("../ShareContextConsumer")),i=f(e("prop-types")),l=f(e("pydio")),s=f(e("pydio/http/policies")),u=e("cells-sdk"),c=f(e("./LinkModel"));function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(n);return e=r?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?b(t):e}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=l.default.requireLib("components").ResourcePoliciesPanel,e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,a["default"].Component);var e,t,n,r=m(i);function i(){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v(b(o=r.call.apply(r,[this].concat(t))),"onSavePolicies",function(n){var e=o.props,t=e.linkModel,r=(e.pydio,t.getLink().UserLogin);s.default.loadPolicies("user",r).then(function(e){var t;e.length&&(t=e[0].Resource,t=o.diffPolicies(e,n,t),s.default.savePolicies("user",r,t))})}),v(b(o),"diffPolicies",function(e,n,r){var o=[];return e.map(function(e){var t=e.Action+"///"+e.Subject;n.remove[t]||o.push(e)}),Object.keys(n.add).map(function(e){var t=new u.ServiceResourcePolicy,n=p(e.split("///"),2),e=n[0],n=n[1];t.Resource=r,t.Effect=u.ServiceResourcePolicyPolicyEffect.constructFromObject("allow"),t.Subject=n,t.Action=e,o.push(t)}),o}),o}return e=i,(t=[{key:"render",value:function(){var e=this.props,t=e.linkModel,n=e.pydio,r=[];r["user:"+t.getLink().UserLogin]=!0;e={READ:r,WRITE:r};return a.default.createElement("div",{style:this.props.style},t.getLink().Uuid&&a.default.createElement(O,{pydio:n,resourceType:"link",description:this.props.getMessage("link.visibility.advanced"),resourceId:t.getLink().Uuid,skipTitle:!0,onSavePolicies:this.onSavePolicies.bind(this),subjectsDisabled:e,subjectsHidden:r,readonly:this.props.isReadonly()||!t.isEditable(),ref:"policies"}))}}])&&y(e.prototype,t),n&&y(e,n),i}();e.PropTypes={pydio:i.default.instanceOf(l.default).isRequired,linkModel:i.default.instanceOf(c.default).isRequired};e=(0,r.default)(e);n.default=e,t.exports=n.default},{"../ShareContextConsumer":1,"./LinkModel":18,"cells-sdk":"cells-sdk","prop-types":"prop-types",pydio:"pydio","pydio/http/policies":"pydio/http/policies",react:"react"}],25:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.ShareViewModal=n.ShareView=void 0;var s=d(e("react")),r=d(e("create-react-class")),i=d(e("prop-types")),a=d(e("pydio")),l=d(e("pydio/http/api")),u=d(e("pydio/model/node")),c=d(e("pydio/util/path")),f=e("cells-sdk"),p=e("material-ui");function d(e){return e&&e.__esModule?e:{default:e}}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function m(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?h(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):h(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=E(n);return e=r?(e=E(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=a.default.requireLib("boot"),S=P.ActionDialogMixin,_=P.Loader,P=a.default.requireLib("components"),j=P.ModalAppBar,M=P.EmptyStateView,C=a.default.requireLib("hoc").ModernTextField,e=e("material-ui/styles").muiThemeable,L=function(){O(t,s["default"].Component);var e=k(t);function t(){return b(this,t),e.apply(this,arguments)}return v(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.onChange,r=e.muiTheme,o=e.m,i={color:"#616161"},e={color:r.palette.accent1Color},r={marginRight:5};return s.default.createElement(p.Tabs,{style:{width:360},onChange:function(e){n(null,0,e)},value:t,tabItemContainerStyle:{background:"transparent"}},s.default.createElement(p.Tab,{label:s.default.createElement("span",null,s.default.createElement("span",{style:r,className:"mdi mdi-share-variant"}),o(243)),value:"LINKS",buttonStyle:"LINKS"===t?e:i}),s.default.createElement(p.Tab,{label:s.default.createElement("span",null,s.default.createElement("span",{style:r,className:"icomoon-cells"}),o(254)),value:"CELLS",buttonStyle:"CELLS"===t?e:i}))}}]),t}(),L=e()(L),R=function(){O(r,s["default"].Component);var n=k(r);function r(e){var t;return b(this,r),(t=n.call(this,e)).state={resources:[],loading:!1,selectedModel:null,shareType:e.defaultShareType||"LINKS"},t}return v(r,[{key:"getChildContext",value:function(){var n=this.props.pydio.MessageHash;return{messages:n,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return n[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var t=this;this.setState({filter:""});var e=new f.ShareServiceApi(l.default.getRestClient()),n=new f.RestListSharedResourcesRequest;n.ShareType=f.ListSharedResourcesRequestListShareType.constructFromObject(this.state.shareType),this.props.subject?n.Subject=this.props.subject:n.OwnedBySubject=!0,this.setState({loading:!0}),e.listSharedResources(n).then(function(e){t.setState({resources:e.Resources||[],loading:!1})}).catch(function(){t.setState({loading:!1})})}},{key:"getLongestPath",value:function(e){if(!e.AppearsIn)return{path:e.Path,basename:e.Path};var t={};e.AppearsIn.map(function(e){t[e.Path]=e});var n=Object.keys(t);n.sort();e=n[n.length-1],n=(n=c.default.getBasename(e))||t[e].WsLabel;return{path:e,appearsIn:t[e],basename:n}}},{key:"goTo",value:function(e){var t=e.Path,n=e.WsLabel,e=e.WsUuid,t=t.split("/");t.shift();t=new u.default(t.join("/"));t.getMetadata().set("repository_id",e),t.getMetadata().set("repository_label",n),this.props.pydio.goTo(t),this.props.onRequestClose()}},{key:"render",value:function(){function o(e){return a.MessageHash["share_center."+e]}var i=this,e=this.state,t=e.loading,n=e.resources,e=e.filter,r=void 0===e?"":e,e=this.props,a=e.pydio,e=e.style;n.sort(function(e,t){e=e.Node.Path,t=t.Node.Path;return e===t?0:t<e?1:-1});var l=a.Registry.getFilesExtensions();return s.default.createElement("div",{style:m(m({},e),{},{display:"flex",flexDirection:"column",overflow:"hidden"})},s.default.createElement("div",{style:{backgroundColor:"#F5F5F5",borderBottom:"1px solid #EEEEEE",display:"flex",paddingRight:16,paddingTop:3}},s.default.createElement(L,{m:o,value:this.state.shareType,onChange:function(e,t,n){i.setState({shareType:n},function(){i.load()})}}),s.default.createElement("span",{style:{flex:1}}),s.default.createElement("div",{style:{width:150}},s.default.createElement(C,{hintText:o("sharelist.quick-filter"),value:r,onChange:function(e,t){i.setState({filter:t})},fullWidth:!0}))),t&&s.default.createElement(_,{style:{height:400}}),!t&&0===n.length&&s.default.createElement(M,{pydio:a,iconClassName:"mdi mdi-share-variant",primaryTextId:o(131),style:{flex:1,height:400,padding:"90px 0",backgroundColor:"transparent"}}),!t&&0<n.length&&s.default.createElement(p.List,{style:{flex:1,minHeight:400,maxHeight:400,overflowY:"auto",paddingTop:0}},n.map(function(e){var t,n=i.getLongestPath(e.Node),r=n.appearsIn,n=n.basename;return t=-1===n.indexOf(".")?"mdi mdi-folder":(t=c.default.getFileExtension(n),l.has(t)?"mdi mdi-"+l.get(t).fontIcon:"mdi mdi-file"),{primaryText:n=e.Link&&e.Link.Label&&e.Link.Label!==n?e.Link.Label+" ("+n+")":n,secondaryText:e.Link?o(251)+": "+e.Link.Description:o(284).replace("%s",e.Cells.length),icon:t,appearsIn:r}}).filter(function(e){return!r||-1!==e.primaryText.toLowerCase().indexOf(r.toLowerCase())}).map(function(e){var t=e.appearsIn,n=e.icon;return s.default.createElement(p.ListItem,{primaryText:e.primaryText,secondaryText:e.secondaryText,onClick:function(){t&&i.goTo(t)},disabled:!t,leftIcon:s.default.createElement(p.FontIcon,{className:n})})})))}}]),r}();(n.ShareView=R).childContextTypes={messages:i.default.object,getMessage:i.default.func,isReadonly:i.default.func};S=(0,r.default)({displayName:"ShareViewModal",mixins:[S],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this;return s.default.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},s.default.createElement(j,{title:this.props.pydio.MessageHash["share_center.98"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),s.default.createElement(R,y({},this.props,{style:{width:"100%",flex:1},onRequestClose:function(){e.dismiss()}})))}});n.ShareViewModal=S},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/path":"pydio/util/path",react:"react"}],26:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=e("../ShareContextConsumer"))&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(n);return e=r?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("prop-types"),f=e("react").Component,p=e("material-ui").IconButton,d=e("material-ui/styles").muiThemeable,y=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(o,f);var e,t,n,r=s(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return e=o,(t=[{key:"render",value:function(){var e=this.props.muiTheme.palette,t=this.props.destructive?"#d32f2f":e.primary1Color,n={root:{borderRadius:"50%",border:"1px solid "+t,backgroundColor:"transparent",width:36,height:36,padding:"8px 6px",margin:"0 6px",zIndex:0},icon:{color:t,fontSize:20,lineHeight:"20px"}},r=this.props,o=r.tooltip,e=r.messageId,t=r.getMessage,r=r.messageCoreNamespace;return e&&t&&(o=this.props.getMessage(e,r||void 0)),React.createElement(p,{style:n.root,iconStyle:n.icon,onClick:this.props.callback||this.props.onClick,iconClassName:this.props.mdiIcon?"mdi mdi-"+this.props.mdiIcon:this.props.iconClassName,tooltip:o,tooltipPosition:this.props.tooltipPosition})}}])&&a(e.prototype,t),n&&a(e,n),o}();y.propTypes={callback:c.func,onClick:c.func,mdiIcon:c.string,messageId:c.string},y=(0,i.default)(y);y=d()(y);n.default=y,t.exports=n.default},{"../ShareContextConsumer":1,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],27:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,d=(r=e("react"))&&r.__esModule?r:{default:r},y=e("material-ui"),i=e("material-ui/styles");function h(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function m(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(n);return e=r?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(){f(t,d["default"].Component);var e=b(t);function t(){return s(this,t),e.apply(this,arguments)}return c(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,r=e.active,o=e.onChange,n=e.style,i=e.muiTheme.palette.primary1Color;return d.default.createElement("div",{style:m({display:"flex"},n)},t.map(function(e){var t=e.Value===r,n=e.Label;return e.Icon&&(n=d.default.createElement("span",null,d.default.createElement("span",{className:e.Icon,style:{marginLeft:-5}})," ",e.Label)),d.default.createElement(y.FlatButton,{label:n,onClick:function(){o(e.Value)},primary:t,style:{flex:1,height:46,lineHeight:"46px",borderBottom:"3px solid "+(t?i:"transparent")},labelStyle:{textTransform:"none",fontSize:15,paddingLeft:8,paddingRight:8,color:t?i:"rgba(0,0,0,.3)"}})}))}}]),t}(),v=(0,i.muiThemeable)()(v),O=function(){f(t,d["default"].Component);var e=b(t);function t(){return s(this,t),e.apply(this,arguments)}return c(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.active,r=null;return t.map(function(e){e.Value===n&&(r=e.Component)}),r}}]),t}(),i=function(){f(r,d["default"].Component);var n=b(r);function r(e){var t;return s(this,r),(t=n.call(this,e)).state={left:e.tabs.left.length?e.tabs.left[0].Value:"",right:e.tabs.right.length?e.tabs.right[0].Value:""},e.defaultLeft&&(t.state.left=e.defaultLeft),e.defaultRight&&(t.state.right=e.defaultRight),t}return c(r,[{key:"componentWillReceiveProps",value:function(e){!this.props.defaultLeft&&e.defaultLeft?this.setState({left:e.defaultLeft}):!this.state.left&&e.tabs.left.length&&this.setState({left:e.tabs.left[0].Value}),!this.props.defaultRight&&e.defaultRight?this.setState({right:e.defaultRight}):!this.state.right&&e.tabs.right.length&&this.setState({right:e.tabs.right[0].Value})}},{key:"render",value:function(){var t=this,e=this.props,n=e.tabs,r=e.header,o=e.onSaveAction,i=e.onCloseAction,a=e.onRevertAction,l=e.saveEnabled,s=e.style,u=e.pydio,c=e.editorOneColumn,f=this.state,p=f.left,e=f.right;if(c){f=[].concat(h(n.left),h(n.right)),c=f.filter(function(e){return e.AlwaysLast});return(f=c.length?[].concat(h(f.filter(function(e){return!e.AlwaysLast})),h(c)):f).length&&0===f.filter(function(e){return e.Value===p}).length&&(p=f[0].Value),d.default.createElement("div",{style:m({display:"flex",flexDirection:"column",height:"100%"},s)},d.default.createElement("div",{style:{display:"flex",alignItems:"center"}},d.default.createElement("div",{style:{flex:1,padding:10}},r),d.default.createElement(y.IconButton,{iconClassName:"mdi mdi-close",tooltip:u.MessageHash[86],onClick:i,style:{marginRight:10}})),d.default.createElement("div",{style:{display:"flex"}},d.default.createElement(v,{tabs:f,active:p,style:{flex:1,padding:"0 16px"},onChange:function(e){t.setState({left:e})}})),d.default.createElement(y.Divider,{style:{flexShrink:0,backgroundColor:"#e0e0e0"}}),d.default.createElement("div",{style:{display:"flex",flex:1,overflow:"hidden"}},d.default.createElement("div",{style:m({overflowY:"auto",width:"100%",height:"100%"},n.leftStyle)},d.default.createElement(O,{tabs:f,active:p}))),d.default.createElement("div",{style:{borderTop:"1px solid #eeeeee",padding:10,display:"flex",alignItems:"center",justifyContent:"flex-end"}},d.default.createElement(y.FlatButton,{disabled:!l,label:u.MessageHash[628],onClick:a,style:{marginLeft:10}}),d.default.createElement(y.RaisedButton,{disabled:!l,primary:!0,label:u.MessageHash[53],onClick:o})))}return n.left&&n.left.length&&0===n.left.filter(function(e){return e.Value===p}).length&&(p=n.left[0].Value),n.right&&n.right.length&&0===n.right.filter(function(e){return e.Value===p}).length&&(e=n.right[0].Value),d.default.createElement("div",{style:m({backgroundColor:"#fafafa",display:"flex",flexDirection:"column",height:"100%"},s)},d.default.createElement("div",{style:{display:"flex",alignItems:"center",padding:10,paddingBottom:0}},d.default.createElement("div",{style:{flex:1,alignItems:"center",paddingRight:20}},r),d.default.createElement(y.RaisedButton,{disabled:!l,primary:!0,label:u.MessageHash[53],onClick:o}),d.default.createElement(y.FlatButton,{disabled:!l,label:u.MessageHash[628],onClick:a,style:{marginLeft:10}}),d.default.createElement(y.IconButton,{iconClassName:"mdi mdi-close",tooltip:u.MessageHash[86],onClick:i,style:{marginLeft:10}})),d.default.createElement("div",{style:{display:"flex"}},d.default.createElement(v,{tabs:n.left,active:p,style:{flex:1,margin:"0 16px"},onChange:function(e){t.setState({left:e})}}),d.default.createElement(v,{tabs:n.right,active:e,style:{flex:1,margin:"0 16px"},onChange:function(e){t.setState({right:e})}})),d.default.createElement(y.Divider,{style:{flexShrink:0,display:"none"}}),d.default.createElement("div",{style:{display:"flex",flex:1,overflow:"hidden",padding:"0 5px 5px"}},d.default.createElement(y.Paper,{zDepth:1,style:m({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.leftStyle)},d.default.createElement(O,{tabs:n.left,active:p})),d.default.createElement(y.Paper,{zDepth:1,style:m({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.rightStyle)},d.default.createElement(O,{tabs:n.right,active:e}))))}}]),r}();n.default=i,t.exports=n.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",react:"react"}],28:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("react")),a=r(e("../composite/CompositeCard")),l=r(e("../cells/CellCard"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=f(n);return e=r?(e=f(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==o(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(o,i["default"].Component);var e,t,n,r=c(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,e)).state={popoverOpen:!1},e}return e=o,(t=[{key:"openPopover",value:function(e){this.setState({popoverOpen:!0,popoverAnchor:e.target})}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.node,r=e.popoverPanel,e=e.popoverRequestClose;return n.isRoot()?i.default.createElement(PydioWorkspaces.InfoPanelCard,{popoverPanel:r},i.default.createElement("div",{style:{padding:0}},i.default.createElement(l.default,{cellId:t.user.activeRepository,pydio:t,mode:"infoPanel"}))):i.default.createElement(PydioWorkspaces.InfoPanelCard,{popoverPanel:r},i.default.createElement("div",{style:{padding:0}},i.default.createElement(a.default,{node:n,pydio:t,mode:"infoPanel",popoverPanel:r,popoverRequestClose:e})))}}])&&s(e.prototype,t),n&&s(e,n),o}();n.default=e,t.exports=n.default},{"../cells/CellCard":2,"../composite/CompositeCard":9,react:"react"}],29:[function(n,l,u){!function(i){!function(){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var r=e(n("pydio/util/xml")),s=e(n("pydio/http/api")),c=e(n("pydio")),f=n("cells-sdk");function e(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=c.default.requireLib("boot").moment,t=function(){function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u)}var e,t,n;return e=u,n=[{key:"mailerSupported",value:function(e){return e.Parameters.get("validMailer")}},{key:"getAuthorizations",value:function(){var e=c.default.getInstance(),t=e.getPluginConfigs("action.share"),n={folder_public_link:t.get("ENABLE_FOLDER_PUBLIC_LINK"),folder_workspaces:t.get("ENABLE_FOLDER_INTERNAL_SHARING"),file_public_link:t.get("ENABLE_FILE_PUBLIC_LINK"),file_workspaces:t.get("ENABLE_FILE_INTERNAL_SHARING"),editable_hash:t.get("HASH_USER_EDITABLE"),hash_min_length:t.get("HASH_MIN_LENGTH")||6,password_mandatory:!1,max_expiration:t.get("FILE_MAX_EXPIRATION"),max_downloads:t.get("FILE_MAX_DOWNLOAD")},t=t.get("SHARE_FORCE_PASSWORD");return t&&(n.password_mandatory=!0),n.password_placeholder=t?e.MessageHash["share_center.176"]:e.MessageHash["share_center.148"],n}},{key:"buildPublicUrl",value:function(e,t){var n=e.Parameters;if(2<arguments.length&&void 0!==arguments[2]&&arguments[2])return"..."+n.get("PUBLIC_BASEURI")+"/"+t.LinkHash;if(t.LinkUrl&&t.LinkUrl.match(new RegExp("^http://|^https://")))return t.LinkUrl;e=e.getFrontendUrl();return"".concat(e.protocol,"//").concat(e.host)+n.get("PUBLIC_BASEURI")+"/"+t.LinkHash}},{key:"nodeHasEditor",value:function(e,t){var n;return t.getMetadata().has("mime_has_preview_editor")||(e=(n=(n=e.Registry.findEditorsForMime(t.getAjxpMime())).filter(function(e){return"editor.browser"!==e.id&&"editor.other"!==e.id})).filter(function(e){return e.canWrite}),t.getMetadata().set("mime_has_preview_editor",0<n.length),t.getMetadata().set("mime_has_writeable_editor",0<e.length)),{preview:t.getMetadata().get("mime_has_preview_editor"),writeable:t.getMetadata().get("mime_has_writeable_editor")}}},{key:"compileLayoutData",value:function(o,e){var i,a=e.getNode(),e=a.isLeaf()?(i=a.getAjxpMime(),r.default.XPathSelectNodes(o.getXmlRegistry(),"//template[contains(@name, 'unique_preview_')]")):r.default.XPathSelectNodes(o.getXmlRegistry(),"//template[contains(@name, 'minisite_')]");if(!e.length)return[];if(1===e.length)return[{LAYOUT_NAME:e[0].getAttribute("element"),LAYOUT_LABEL:""}];var l=o.Parameters.get("theme"),s=[];return e.map(function(e){var t,n,r=e.getAttribute("theme");r&&r!==l||(t=e.getAttribute("element"),n=e.getAttribute("name"),r=e.getAttribute("label"),i&&"unique_preview_file"===n&&!u.nodeHasEditor(o,a).preview||(r?MessageHash[r]&&(r=MessageHash[r]):r=e.getAttribute("name"),s[n]=t,s.push({LAYOUT_NAME:n,LAYOUT_ELEMENT:t,LAYOUT_LABEL:r})))}),s}},{key:"forceMailerOldSchool",value:function(){return i.pydio.getPluginConfigs("action.share").get("EMAIL_INVITE_EXTERNAL")}},{key:"qrcodeEnabled",value:function(){return i.pydio.getPluginConfigs("action.share").get("CREATE_QRCODE")}},{key:"sendCellInvitation",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},o=u.prepareEmail(e,null,t),i=o.templateId,e=o.templateData,a=new f.MailerMail,t=new f.MailerServiceApi(s.default.getRestClient());a.To=[];var l=0;Object.keys(n).map(function(e){var t=n[e],e=new f.MailerUser;return t.IdmUser&&t.IdmUser.Login&&t.IdmUser.Attributes&&(t.IdmUser.Attributes.hasEmail||t.IdmUser.Attributes.email)?(e.Uuid=t.IdmUser.Login,a.To.push(e)):l++,e});o=c.default.getInstance().MessageHash;a.To.length?(a.TemplateId=i,a.TemplateData=e,t.send(a).then(function(){r()}),t=o["core.mailer.1"].replace("%s",a.To.length),0<l&&(t+=" "+o["core.mailer.entries.ignored"]),c.default.getInstance().UI.displayMessage("SUCCESS",t)):c.default.getInstance().UI.displayMessage("ERROR",o["core.mailer.entries.ignored"])}},{key:"prepareEmail",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r={},o="",i=pydio.user;return i.getPreference("displayName")?r.Inviter=i.getPreference("displayName"):r.Inviter=i.id,t?(i=t.getLink(),e.isLeaf()?(o="PublicFile",r.FileName=i.Label||e.getLabel()):(o="PublicFolder",r.FolderName=i.Label||e.getLabel()),r.LinkPath="/public/"+i.LinkHash,i.MaxDownloads&&(r.MaxDownloads=i.MaxDownloads+""),i.AccessEnd&&(i=a(new Date(1e3*i.AccessEnd)),r.Expire=i.format("LL"))):(o="Cell",r.Cell=n.getLabel()),{templateId:o,templateData:r,message:"",linkModel:t}}}],(t=null)&&o(e.prototype,t),n&&o(e,n),u}();u.default=t,l.exports=u.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/xml":"pydio/util/xml"}]},{},[15])(15)});